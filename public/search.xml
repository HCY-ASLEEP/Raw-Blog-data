<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>MySQL 闲谈</title>
      <link href="/2022/11/05/MySQL-%E9%97%B2%E8%B0%88/"/>
      <url>/2022/11/05/MySQL-%E9%97%B2%E8%B0%88/</url>
      
        <content type="html"><![CDATA[<div align="left"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">对MySQL InnoDB引擎的索引了解吗？</div></div></div><h6 id=""><a href="#" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">嗯啊，使用索引可以加快查询速度，其实就是将无序的数据变成有序（有序就能加快检索速度）</div></div></div><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">在InnoDB引擎中，索引的底层数据结构是B+树</div></div></div><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><div align="left"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">那为什么不使用红黑树或者B树呢？</div></div></div><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">MySQL的数据是存储在硬盘的，在查询时一般是不能「一次性」把全部数据加载到内存中</div></div></div><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">红黑树是「二叉查找树」的变种，一个Node节点只能存储一个Key和一个Value</div></div></div><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">B和B+树跟红黑树不一样，它们算是「多路搜索树」，相较于「二叉搜索树」而言，一个Node节点可以存储的信息会更多，「多路搜索树」的高度会比「二叉搜索树」更低</div></div></div><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">了解了区别之后，其实就很容易发现，在数据不能一次加载至内存的场景下，数据需要被检索出来，选择B或B+树的理由就很充分了（一个Node节点存储信息更多（相较于二叉搜索树），树的高度更低，树的高度影响检索的速度）</div></div></div><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">B+树相对于B树而言，它又有两种特性</div></div></div><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">一、B+树非叶子节点不存储数据，在相同的数据量下，B+树更加矮壮。（这个应该不用多解释了，数据都存储在叶子节点上，非叶子节点的存储能存储更多的索引，所以整棵树就更加矮壮）</div></div></div><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">二、B+树叶子节点之间组成一个链表，方便于遍历查询（遍历操作在MySQL中比较常见）</div></div></div><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6><div align="right"><div style="width:80%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%"><img src="../pictures/MySQL-闲谈/v2-54a18a07f7adfbda09983b815a92c5b8_r.jpg"/></div></div></div><h6 id="-11"><a href="#-11" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">我稍微解释一下吧，你可以脑补下画面</div></div></div><h6 id="-12"><a href="#-12" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">我们在MySQL InnoDB引擎下，每创建一个索引，相当于生成了一颗B+树</div></div></div><h6 id="-13"><a href="#-13" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">如果该索引是「聚集(聚簇)索引」，那当前B+树的叶子节点存储着「主键和当前行的数据」</div></div></div><h6 id="-14"><a href="#-14" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">如果该索引是「非聚簇索引」，那当前B+树的叶子节点存储着「主键和当前索引列值」</div></div></div><h6 id="-15"><a href="#-15" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">比如写了一句sql：select * from user where id >=10，那只要定位到id为10的记录，然后在叶子节点之间通过遍历链表(叶子节点组成的链表)，即可以找到往后的记录了</div></div></div><h6 id="-16"><a href="#-16" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">由于B树是会在非叶子节点也存储数据，要遍历的时候可能就得跨层检索，相对麻烦些</div></div></div><h6 id="-17"><a href="#-17" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">基于树的层级以及业务使用场景的特性，所以MySQL选择了B+树作为索引的底层数据结构</div></div></div><h6 id="-18"><a href="#-18" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">对于哈希结构，其实InnoDB引擎是「自适应」哈希索引的（hash索引的创建由InnoDB存储引擎引擎自动优化创建，我们是干预不了）</div></div></div><h6 id="-19"><a href="#-19" class="headerlink" title=""></a></h6><div align="left"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">嗯…那我了解了，顺便想问下，你知道什么叫做回表吗？</div></div></div><h6 id="-20"><a href="#-20" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">所谓的回表其实就是，当我们使用索引查询数据时，检索出来的数据可能包含其他列，但走的索引树叶子节点只能查到当前列值以及主键ID，所以需要根据主键ID再去查一遍数据，得到SQL 所需的列</div></div></div><h6 id="-21"><a href="#-21" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">举个例子，我这边建了给订单号ID建了个索引，但我的SQL 是：select orderId,orderName from orderdetail where orderId = 123</div></div></div><h6 id="-22"><a href="#-22" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">SQL都订单ID索引，但在订单ID的索引树的叶子节点只有orderId和Id，而我们还想检索出orderName，所以MySQL 会拿到ID再去查出orderName给我们返回，这种操作就叫回表</div></div></div><h6 id="-23"><a href="#-23" class="headerlink" title=""></a></h6><div align="right"><div style="width:80%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%"><img src="../pictures/MySQL-闲谈/v2-2393680d1df54c696f97c8194b34237c_r.jpg"/></div></div></div><h6 id="-24"><a href="#-24" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">想要避免回表，也可以使用覆盖索引（能使用就使用，因为避免了回表操作）</div></div></div><h6 id="-25"><a href="#-25" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">所谓的覆盖索引，实际上就是你想要查出的列刚好在叶子节点上都存在，比如我建了orderId和orderName联合索引，刚好我需要查询也是orderId和orderName，这些数据都存在索引树的叶子节点上，就不需要回表操作了</div></div></div><h6 id="-26"><a href="#-26" class="headerlink" title=""></a></h6><div align="left"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">既然你也提到了联合索引，我想问下你了解最左匹配原则吗？</div></div></div><h6 id="-27"><a href="#-27" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">嗯，说明这个概念，还是举例子比较容易说明</div></div></div><h6 id="-28"><a href="#-28" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">如有索引 (a,b,c,d)，查询条件 a=1 and b=2 and c>3 and d=4，则会在每个节点依次命中a、b、c，无法命中d</div></div></div><h6 id="-29"><a href="#-29" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">先匹配最左边的，索引只能用于查找key是否存在（相等），遇到范围查询 (>、<、between、like左匹配)等就不能进一步匹配了，后续退化为线性查找</div></div></div><h6 id="-30"><a href="#-30" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">这就是最左匹配原则</div></div></div><h6 id="-31"><a href="#-31" class="headerlink" title=""></a></h6><div align="right"><div style="width:80%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%"><img src="../pictures/MySQL-闲谈/v2-6d6af5c6cfe9be27d1f41af4d7860d3a_r.jpg"/></div></div></div><h6 id="-32"><a href="#-32" class="headerlink" title=""></a></h6><div align="left"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">嗯嗯，我还想问下你们主键是怎么生成的？</div></div></div><h6 id="-33"><a href="#-33" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">主键就自增的</div></div></div><h6 id="-34"><a href="#-34" class="headerlink" title=""></a></h6><div align="left"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">那假设我不用MySQL自增的主键，你觉得会有什么问题呢？</div></div></div><h6 id="-35"><a href="#-35" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">首先主键得保证它的唯一性和空间尽可能短吧，这两块是需要考虑的</div></div></div><h6 id="-36"><a href="#-36" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">另外，由于索引的特性（有序），如果生成像uuid类似的主键，那插入的的性能是比自增的要差的</div></div></div><h6 id="-37"><a href="#-37" class="headerlink" title=""></a></h6><div align="right"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">因为生成的uuid，在插入时有可能需要移动磁盘块（比如，块内的空间在当前时刻已经存储满了，但新生成的uuid需要插入已满的块内，就需要移动块的数据）</div></div></div><h6 id="-38"><a href="#-38" class="headerlink" title=""></a></h6><div align="left"><div style="width:60%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%">OK…</div></div></div><h6 id="-39"><a href="#-39" class="headerlink" title=""></a></h6><div align="right"><div style="width:80%; border-style:solid; border-width:1px; border-radius:15px"><div style="text-align:center;margin:5%"><img src="../pictures/MySQL-闲谈/v2-6d6af5c6cfe9be27d1f41af4d7860d3a_r.jpg"/></div></div></div>]]></content>
      
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
            <tag> MySQL </tag>
            
            <tag> 对话 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown 对话框</title>
      <link href="/2022/11/05/Markdown-%E5%AF%B9%E8%AF%9D%E6%A1%86%E7%AC%94%E8%AE%B0/"/>
      <url>/2022/11/05/Markdown-%E5%AF%B9%E8%AF%9D%E6%A1%86%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h3><img src="/pictures/markdown 对话框/2022.11.05.21.09.58.png"/><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;div align=&quot;right&quot;&gt;</span><br><span class="line">&lt;div style=&quot;width:47%; border-style:solid; border-width:1px; border-radius:15px&quot;&gt;</span><br><span class="line">&lt;div style=&quot;text-align:center;margin:5%&quot;&gt;</span><br><span class="line">这是右边</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">###### </span><br><span class="line"></span><br><span class="line">&lt;div align=&quot;left&quot;&gt;</span><br><span class="line">&lt;div style=&quot;width:47%; border-style:solid; border-width:1px; border-radius:15px&quot;&gt;</span><br><span class="line">&lt;div style=&quot;text-align:center;margin:5%&quot;&gt;</span><br><span class="line">这是左边</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> -Markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux 查看硬盘空间</title>
      <link href="/2022/11/05/Linux-%E6%9F%A5%E7%9C%8B%E7%A1%AC%E7%9B%98%E7%A9%BA%E9%97%B4/"/>
      <url>/2022/11/05/Linux-%E6%9F%A5%E7%9C%8B%E7%A1%AC%E7%9B%98%E7%A9%BA%E9%97%B4/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">du -sh ./*</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VLC Linux 安装在自定义目录</title>
      <link href="/2022/11/05/VLC-Linux-%E5%AE%89%E8%A3%85%E5%9C%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%AE%E5%BD%95/"/>
      <url>/2022/11/05/VLC-Linux-%E5%AE%89%E8%A3%85%E5%9C%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%AE%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p>apt 只下载包及其依赖而不安装</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># sudo apt-get install -d &lt;软件包&gt;</span><br><span class="line">sudo apt-get install -d vlc</span><br></pre></td></tr></table></figure><p>这将会下载到这个目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/var/cache/apt/archives/</span><br></pre></td></tr></table></figure><p>为了只是获得想要的包和依赖，应该先清空这个目录再下载</p><p>将 <strong>&#x2F;var&#x2F;cache&#x2F;apt&#x2F;archives&#x2F;</strong> 的包以及依赖移到某一个目录保存</p><p>然后把这些包安装到指定目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">for file in packagesPath:</span><br><span class="line">do </span><br><span class="line">echo $file</span><br><span class="line">sudo dpkg -x $file customInstallPath</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>在 customInstallPath 下编写一个启动脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">HERE=&quot;$(dirname &quot;$(readlink -f &quot;$0&quot;)&quot;)&quot;</span><br><span class="line">export UNION_PRELOAD=$HERE</span><br><span class="line">export LD_PRELOAD=$HERE/libunionpreload.so</span><br><span class="line">export PATH=$HERE/usr/bin/:$HERE/usr/sbin/:$HERE/usr/games/:$HERE/bin/:$HERE/opt/vlc/:$HERE/sbin/:$PATH</span><br><span class="line">export LD_LIBRARY_PATH=/usr/lib/x86_64-linux-gnu/:$HERE/usr/lib/:$HERE/usr/lib/x86_64-linux-gnu/:$HERE/lib/:$HERE/lib/x86_64-linux-gnu/:$HERE/usr/lib/x86_64-linux-gnu/vlc/:$LD_LIBRARY_PATH</span><br><span class="line">export QT_PLUGIN_PATH=/usr/lib/x86_64-linux-gnu/qt5/plugins/:$HERE/usr/lib/x86_64-linux-gnu/qt5/plugins/:$QT_PLUGIN_PATH</span><br><span class="line">export XDG_DATA_DIRS=$HERE/usr/share/:$XDG_DATA_DIRS</span><br><span class="line">exec $HERE/usr/bin/vlc &quot;$@&quot;</span><br></pre></td></tr></table></figure><p>保存并赋予这个启动脚本执行权限</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod a+x launch.sh</span><br></pre></td></tr></table></figure><p>执行 launch.sh 就可以运行 vlc 了</p><p>这个脚本里面的 bash 变量是程序内部执行需要的变量，并不是环境变量，只有知道软件构建运行的源码才可以写出来，所以这个脚本并不是通用的，只适合 vlc</p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Wayland Wemeet</title>
      <link href="/2022/11/05/wayland-wemeet/"/>
      <url>/2022/11/05/wayland-wemeet/</url>
      
        <content type="html"><![CDATA[<p>腾讯会议不支持 Wayland</p><img src="/pictures/wayland-wemeet/2022-04-19-13-25-31屏幕截图.png"/><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p>解决方法</p><ul><li><p>进入 &#x2F;opt&#x2F;wemeet 目录</p></li><li><p>编辑 wemeetapp.sh 文件</p></li><li><p>在 export QT_PLUGIN_PATH&#x3D;”${HERE}&#x2F;plugins” 后添加如下三行代码后保存</p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export XDG_SESSION_TYPE=x11</span><br><span class="line">export QT_QPA_PLATFORM=xcb</span><br><span class="line">unset WAYLAND_DISPLAY</span><br></pre></td></tr></table></figure></li><li><p>重启即可</p></li></ul><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><p>缺点</p><ul><li>由于 Wayland 的限制，腾讯会议现在无法捕捉到屏幕，自然“共享屏幕”也就失效了，实际效果是当尝试共享屏幕时，共享的是 pure black</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Wayland </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MARO Distibuted Toolkit</title>
      <link href="/2022/11/04/MARO-Distibuted-toolkit/"/>
      <url>/2022/11/04/MARO-Distibuted-toolkit/</url>
      
        <content type="html"><![CDATA[<h3 id="MARO-三层框架"><a href="#MARO-三层框架" class="headerlink" title="MARO 三层框架"></a>MARO 三层框架</h3><img src="/pictures/maro-distributed-toolkit/maro_overview.svg"/><h6 id=""><a href="#" class="headerlink" title=""></a></h6><h4 id="接下来展示的是第三层-Distibuted-toolkit"><a href="#接下来展示的是第三层-Distibuted-toolkit" class="headerlink" title="接下来展示的是第三层 Distibuted toolkit"></a>接下来展示的是第三层 Distibuted toolkit</h4><img src="/pictures/maro-distributed-toolkit/overview.svg"/><ul><li><p>MARO Distibuted Toolkit 遵循 message-passing 模式，即不同组件之间的协作基于消息<strong>发送</strong>和<strong>接收</strong></p></li><li><p>典型的 <strong>master&#x2F;worker</strong> 分布式程序通常包含以下步骤</p><ul><li>master 会将任务（w&#x2F; or w&#x2F;o data）发送到 worker</li><li>worker 将在其本地计算环境或本地设备中完成任务</li><li>worker 将计算结果返回到 master</li></ul></li></ul><img src="/pictures/maro-distributed-toolkit/v2-b5f0db269480aceb6590007f8ad9dfe8_r.jpg" style="zoom:40%"/>    <ul><li>根据实际需要，主控组件和工作组件之间的通信方式可以是同步的，也可以是异步的</li></ul><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><h4 id="关键部件"><a href="#关键部件" class="headerlink" title="关键部件"></a>关键部件</h4><img src="/pictures/maro-distributed-toolkit/key_components.svg"/> <ul><li><h5 id="Comunication"><a href="#Comunication" class="headerlink" title="Comunication"></a>Comunication</h5><ul><li><h5 id="大致功能预览"><a href="#大致功能预览" class="headerlink" title="大致功能预览"></a>大致功能预览</h5><ul><li><p>提供通用的消息传递接口</p><ul><li>send, receive</li><li>broadcast</li><li>scatter</li></ul></li></ul><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><ul><li><p>通信组件使用<strong>可替换</strong>的通信协议驱动程序来适应不同的通信协议栈</p><ul><li>TCP&#x2F;IP</li><li>InfiniBand</li></ul></li></ul><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><ul><li><p>Peer Discovering</p></li><li><p>部分故障恢复</p></li><li><p>条件事件自动调度</p></li></ul></li></ul><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><ul><li><h5 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h5>  <img src="/pictures/maro-distributed-toolkit/proxy.svg"/><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><ul><li>Proxy 提供通信原语的实现，是通信操作接口，是通信组件的主要实体</li><li>Proxy 默认使用 ZeroMQ 框架</li><li>Proxy 为基于 Redis 的 peer discovering 提供支持</li><li>分布式通信原语常见操作如下<h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><ul><li><p><strong>Broadcast</strong></p>  <img src="/pictures/maro-distributed-toolkit/v2-c9aa7762a6ec00d370c58de183441362_r.jpg"/>  <img src="/pictures/maro-distributed-toolkit/v2-1ff295f93679ebe9a03ad510259ead8b_r.jpg"/></li></ul><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><ul><li><p><strong>Scatter</strong></p>  <img src="/pictures/maro-distributed-toolkit/v2-be03c436a4f699aa001deb4490f33813_r.jpg"/>  <img src="/pictures/maro-distributed-toolkit/v2-f17bd118677f919e255d5b1689fc66dc_r.jpg"/></li></ul><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6><h6 id="-11"><a href="#-11" class="headerlink" title=""></a></h6><h6 id="-12"><a href="#-12" class="headerlink" title=""></a></h6><ul><li><p><strong>Reduce (强调聚合之后处理)</strong></p>  <img src="/pictures/maro-distributed-toolkit/v2-466054a11a994842eb1b062b13b9bde3_r.png"/>    <img src="/pictures/maro-distributed-toolkit/v2-c7bdad601780f9798a62c2dfb1bbef4d_r.jpg"/></li></ul><h6 id="-13"><a href="#-13" class="headerlink" title=""></a></h6><h6 id="-14"><a href="#-14" class="headerlink" title=""></a></h6><h6 id="-15"><a href="#-15" class="headerlink" title=""></a></h6><ul><li><p><strong>Gather (单纯聚合没有额外处理)</strong></p>  <img src="/pictures/maro-distributed-toolkit/v2-3b2ec50810fc8d92971a4b7c0b800b1b_r.jpg"/>  <img src="/pictures/maro-distributed-toolkit/v2-dc3fcf248c39b4a76947bcea140840d1_720w.webp"/></li></ul><h6 id="-16"><a href="#-16" class="headerlink" title=""></a></h6><h6 id="-17"><a href="#-17" class="headerlink" title=""></a></h6><h6 id="-18"><a href="#-18" class="headerlink" title=""></a></h6><ul><li><p><strong>All Reduce</strong></p>  <img src="/pictures/maro-distributed-toolkit/v2-0e90f4c9b66d42dfa41145d3b6a52361_r.jpg"/>  <img src="/pictures/maro-distributed-toolkit/v2-80b1bd60a2fdefb19f792fdf193c6d76_r.jpg"/></li></ul><h6 id="-19"><a href="#-19" class="headerlink" title=""></a></h6><h6 id="-20"><a href="#-20" class="headerlink" title=""></a></h6><h6 id="-21"><a href="#-21" class="headerlink" title=""></a></h6><ul><li><p><strong>All Gather</strong></p>  <img src="/pictures/maro-distributed-toolkit/v2-ce5261aec55090a1f9e9dd5233b22af9_r.jpg"/>    <img src="/pictures/maro-distributed-toolkit/v2-831e0b04646c78f9e74bf4f29c35b8af_720w.webp"/></li></ul><h6 id="-22"><a href="#-22" class="headerlink" title=""></a></h6><h6 id="-23"><a href="#-23" class="headerlink" title=""></a></h6><h6 id="-24"><a href="#-24" class="headerlink" title=""></a></h6><ul><li><p><strong>Reduce Scatter</strong></p>  <img src="/pictures/maro-distributed-toolkit/v2-14cdd631faae00452885a116dd36737c_720w.webp"/></li></ul><h6 id="-25"><a href="#-25" class="headerlink" title=""></a></h6><h6 id="-26"><a href="#-26" class="headerlink" title=""></a></h6><h6 id="-27"><a href="#-27" class="headerlink" title=""></a></h6><ul><li><p><strong>All to All</strong></p>  <img src="/pictures/maro-distributed-toolkit/v2-945ffd7612632fa88ed2bc68ec832071_r.jpg"/></li></ul></li></ul></li></ul><h6 id="-28"><a href="#-28" class="headerlink" title=""></a></h6><ul><li><p><strong>Message</strong></p><ul><li><p>用于打包组件之间的通信内容，消息实例的主要属性包括</p><ul><li>tag：自定义属性，可用于通过 <strong>conditional event register table</strong> 实现自动调度逻辑</li><li>source：message 发送者的别名</li><li>destination：message 接收者的别名</li><li>payload：用于远程函数调用的 Python 对象</li><li>session_id（自动生成）：特定会话的 UUID ，一个会话可能包含多条消息</li><li>message_id（自动生成）：特定消息的 UUID</li></ul></li></ul><h6 id="-29"><a href="#-29" class="headerlink" title=""></a></h6><ul><li><p>Example</p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from maro.communication import Message</span><br><span class="line"></span><br><span class="line">message = Message(tag=&quot;check_in&quot;,</span><br><span class="line">                  source=&quot;worker_001&quot;,</span><br><span class="line">                  destination=&quot;master&quot;,</span><br><span class="line">                  body=&quot;&quot;)</span><br></pre></td></tr></table></figure></li></ul></li></ul><h6 id="-30"><a href="#-30" class="headerlink" title=""></a></h6><ul><li><p><strong>Session Message</strong></p><ul><li><p>MARO 为常见的分布式场景提供了两种预定义的会话类型</p><ul><li><p><strong>Task Session</strong></p><ul><li><p>存在 master 和 worker 关系</p></li><li><p>用于描述从 master 发送到 worker 的 computing task</p><ul><li>master 将 task 发送给 worker</li><li>一旦 worker 收到 task ，worker 就开始执行 task</li><li>worker 将 computing result 返回给 master</li></ul></li></ul></li></ul><h6 id="-31"><a href="#-31" class="headerlink" title=""></a></h6><ul><li><p><strong>Notification Session</strong></p><ul><li><p>sender 和 receiver 关系</p></li><li><p>用于信息同步</p><ul><li>sender 发送 notification message</li><li>receiver 接收 notification message</li></ul></li></ul></li></ul></li></ul><h6 id="-32"><a href="#-32" class="headerlink" title=""></a></h6><ul><li>session 的每个阶段由 proxy 在内部维护</li><li>Example  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from maro.communication import SessionMessage, SessionType</span><br><span class="line"></span><br><span class="line">task_message = SessionMessage(tag=&quot;sum&quot;,</span><br><span class="line">                              source=&quot;master&quot;,</span><br><span class="line">                              destination=&quot;worker_001&quot;,</span><br><span class="line">                              body=[0, 1, 2, ...],</span><br><span class="line">                              session_type=SessionType.TASK)</span><br><span class="line"></span><br><span class="line">notification_message = SessionMessage(tag=&quot;check_out&quot;,</span><br><span class="line">                                      source=&quot;worker_001&quot;,</span><br><span class="line">                                      destination=&quot;master&quot;,</span><br><span class="line">                                      body=&quot;&quot;,</span><br><span class="line">                                      session_type=SessionType.NOTIFICATION)</span><br></pre></td></tr></table></figure></li></ul></li></ul><h6 id="-33"><a href="#-33" class="headerlink" title=""></a></h6><ul><li><h5 id="MARO-通信原语实际接口"><a href="#MARO-通信原语实际接口" class="headerlink" title="MARO 通信原语实际接口"></a>MARO 通信原语实际接口</h5><ul><li>receive：用于持续接收消息<br>  receive_by_id：仅接收具有给定 session ID 的消息</li><li>send：单播，这是一种阻塞、一对一的发送模式，监视并收集来自远程对等方的回复消息   </li><li>isend：非阻塞版的 send ，将立即返回 message session ID，该 ID 可由  receive_by_id 使用</li><li>scatter：send 的高级版本，用于向 peer 发送消息，并监视和收集来自 peer 的回复消息，不是真正的多播，每条消息都会经过完整的 TCP&#x2F;IP 堆栈（ZeroMQ driver），如果要发送的消息完全相同，并且想要更好的性能，请改用 broadcast 接口</li><li>iscatter：非阻塞版本的 scatter ，message session ID 将立即返回，可由 receive_by_id 使用</li><li>broadcast：阻塞，用于向所有订阅者广播消息，将监视并收集所有订阅者的回复消息</li><li>ibroadcast：非阻塞版本的 broadcast ，相关 message session ID 将立即返回，可供 receive_by_id 使用</li></ul></li></ul><h6 id="-34"><a href="#-34" class="headerlink" title=""></a></h6><ul><li><h5 id="Conditional-Event-Register-Table"><a href="#Conditional-Event-Register-Table" class="headerlink" title="Conditional Event Register Table"></a>Conditional Event Register Table</h5><ul><li>提供消息自动发送机制</li><li>通过将 conditional event 和相关的 handler function 注册到注册表中，当 conditional event 满足时，handler function 将与接收到的消息一起自动执行</li></ul><h6 id="-35"><a href="#-35" class="headerlink" title=""></a></h6>  <img src="/pictures/maro-distributed-toolkit/register_table.register.svg"/>  <h6 id="-36"><a href="#-36" class="headerlink" title=""></a></h6><ul><li><p>conditional event 用于声明自动触发相关 handler function 所需的消息组</p></li><li><p>unit event 是条件事件中的最小组件，声明格式分三段</p><ul><li>source：用于声明所需的消息源</li><li>tag：消息实例的属性</li><li>amount：所需的消息实例量</li></ul>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">unit_event_abs = &quot;worker:update:10&quot;</span><br><span class="line"></span><br><span class="line">unit_event_rel = &quot;worker:update:60%&quot;</span><br></pre></td></tr></table></figure></li><li><p>AND OR 操作支持更复杂的业务逻辑</p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">combined_event_and = (&quot;worker_01:update:2&quot;,</span><br><span class="line">                   &quot;worker_02:update:3&quot;,</span><br><span class="line">                   &quot;AND&quot;)</span><br><span class="line"></span><br><span class="line">combined_event_or = (&quot;worker_03:update:1&quot;,</span><br><span class="line">                      &quot;worker_04:update:5&quot;,</span><br><span class="line">                      &quot;OR&quot;)</span><br><span class="line"></span><br><span class="line">combined_event_mix = ((&quot;worker_01:update:2&quot;, &quot;worker_02:update:3&quot;, &quot;AND&quot;),</span><br><span class="line">                      &quot;worker_03:update:1&quot;,</span><br><span class="line">                      &quot;OR&quot;)</span><br></pre></td></tr></table></figure></li><li><p>Handler function 是绑定到特定 conditional event 的用户定义的回调函数，当满足事件的条件时，相关消息将被发送到处理程序函数执行</p>  <img src="/pictures/maro-distributed-toolkit/register_table.trigger.svg"/>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># A common handler function signature</span><br><span class="line">def handler(that, proxy, messages):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">        Conditional event handler function.</span><br><span class="line"></span><br><span class="line">        Args:</span><br><span class="line">            that: local instance reference, which needs to be operated.</span><br><span class="line">            proxy: the proxy reference for remote communication.</span><br><span class="line">            messages: received messages.</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    pass</span><br></pre></td></tr></table></figure></li></ul></li></ul><h6 id="-37"><a href="#-37" class="headerlink" title=""></a></h6><ul><li><h5 id="Distributed-Decorator"><a href="#Distributed-Decorator" class="headerlink" title="Distributed Decorator"></a>Distributed Decorator</h5><ul><li><p>从本地函数类生成分布式 worker 类的帮助程序</p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from maro.communication import dist, Proxy</span><br><span class="line"></span><br><span class="line"># Initialize proxy instance for remote communication.</span><br><span class="line">proxy = Proxy(group_name=&quot;master-worker&quot;,</span><br><span class="line">              component_type=&quot;worker&quot;,</span><br><span class="line">              expected_peers=[(&quot;master&quot;, 1)])</span><br><span class="line"></span><br><span class="line"># Declare the trigger condition of rollout event.</span><br><span class="line">rollout_event = &quot;master:rollout:1&quot;</span><br><span class="line"></span><br><span class="line"># Implement rollout event handler logic.</span><br><span class="line">def on_rollout(that, proxy, messages):</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line"># Assemble event-handler directory.</span><br><span class="line">handler_dict = &#123;rollout_event: on_rollout&#125;</span><br><span class="line"></span><br><span class="line"># Convert a local functional class to a distributed one.</span><br><span class="line">@dist(proxy, handler_dict)</span><br><span class="line">class Worker:</span><br><span class="line">    def __init__(self):</span><br><span class="line">        pass</span><br></pre></td></tr></table></figure></li></ul></li></ul></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> MARO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VIM 配置</title>
      <link href="/2022/10/29/VIM-%E9%85%8D%E7%BD%AE/"/>
      <url>/2022/10/29/VIM-%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h3 id="VIM-配置说明"><a href="#VIM-配置说明" class="headerlink" title="VIM 配置说明"></a>VIM 配置说明</h3><ol><li><p>安装 neovim 可以直接从 github 下载 appimage</p></li><li><p>配置 neovim 首次启动使用 :checkhealth 查看配置的路径等信息</p></li><li><p>coc.nvim 的 LSP 服务需要 npm （ node.js ）提供支持，npm 安装的时候可以从官方网站那里下载然后安装到指定 path，之后的 -g 安装 npm 包的时候包会安装在安装 npm 的目录下面</p></li><li><p>注意这个 coc-setting.json 这个在安装了 coc.nvim 之后可以 :CocConfig 来进行编辑，json 里面这一句话一定要加上，解决了初次 tab 选中的问题</p></li><li><p>配置文件 init.vim 位于 &#x2F;home&#x2F;asleep&#x2F;.config&#x2F;nvim 下，coc-settings.json 也是在这个路径下面</p></li><li><p>vimplug 管理插件，这里有点特殊，这里我将其他插件安装在与 vimplug 的 plug.vim 同一个目录下面，即  &#x2F;home&#x2F;asleep&#x2F;.local&#x2F;share&#x2F;nvim&#x2F;site&#x2F;autoload</p></li><li><p>安装各种插件之前，应该要了解各个插件的依赖</p></li><li><p>至于 vimplug 的安装，只需要把 github 上面的那个 plug.vim 文件弄下来放在上面说的那个 path 下面就可以调用 :PlugInstall，不用整个仓库弄下来</p></li><li><p>至于 coc 的插件，coc.nvim 是一个插件管理器，coc.nvim 管理的插件在 &#x2F;home&#x2F;asleep&#x2F;.config&#x2F;coc&#x2F;extensions 下面</p></li><li><p>综上所述，如果要迁移 nvim 及其配置，只需要复制</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/home/asleep/.config/coc/extensions   “coc-extensions”</span><br><span class="line"></span><br><span class="line">/home/asleep/.config/nvim   “coc-settings.json”  “init.vim“</span><br><span class="line"></span><br><span class="line">/home/asleep/.local/share/nvim/site/autoload   “plug.vim” “vim-plug extensions”</span><br></pre></td></tr></table></figure></li><li><p>这三个路径下的文件就可以完成迁移 </p></li><li><p>每次修改 init.vim 之后，都要 :so % 即 :source init.vim 生效</p></li></ol><h6 id=""><a href="#" class="headerlink" title=""></a></h6><h3 id="coc-setting-json"><a href="#coc-setting-json" class="headerlink" title="coc-setting.json"></a>coc-setting.json</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;suggest.noselect&quot;: true,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><h3 id="init-vim-已启用的配置"><a href="#init-vim-已启用的配置" class="headerlink" title="init.vim 已启用的配置"></a>init.vim 已启用的配置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line">&quot; -------------------------------------------------------------------------------------------------------------</span><br><span class="line">&quot; ---------------------------------------------common-start----------------------------------------------------</span><br><span class="line">&quot; -------------------------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">set number</span><br><span class="line">set mouse=c</span><br><span class="line">set tabstop=4</span><br><span class="line">set autoindent</span><br><span class="line">set backspace=indent,eol,start</span><br><span class="line">set hlsearch</span><br><span class="line">set clipboard+=unnamedplus</span><br><span class="line">set foldmethod=syntax</span><br><span class="line">set nofoldenable</span><br><span class="line">&quot; 自动同步</span><br><span class="line">set autoread</span><br><span class="line">set fillchars=eob:\ </span><br><span class="line"></span><br><span class="line">&quot; Vim jump to the last position when reopening a file</span><br><span class="line">if has(&quot;autocmd&quot;)</span><br><span class="line">  au BufReadPost * if line(&quot;&#x27;\&quot;&quot;) &gt; 1 &amp;&amp; line(&quot;&#x27;\&quot;&quot;) &lt;= line(&quot;$&quot;) | exe &quot;normal! g&#x27;\&quot;&quot; | endif</span><br><span class="line">endif</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function! ESC_IMAP()</span><br><span class="line">    let l:frontChar = getline(&#x27;.&#x27;)[col(&#x27;.&#x27;) - 2]</span><br><span class="line">    if l:frontChar == &quot;;&quot; </span><br><span class="line">        call feedkeys(&quot;\&lt;BS&gt;\&lt;BS&gt;\&lt;ESC&gt;&quot;, &#x27;n&#x27;)</span><br><span class="line">    else</span><br><span class="line">        call feedkeys(&quot;\&lt;BS&gt;\;&quot;, &#x27;n&#x27;)</span><br><span class="line">    endif</span><br><span class="line">endfunction</span><br><span class="line">inoremap &lt;expr&gt; ; ESC_IMAP()</span><br><span class="line"></span><br><span class="line">set timeoutlen=200</span><br><span class="line"></span><br><span class="line">nnoremap ;; &lt;ESC&gt;</span><br><span class="line">vnoremap ;; &lt;ESC&gt;</span><br><span class="line">snoremap ;; &lt;ESC&gt;</span><br><span class="line">xnoremap ;; &lt;ESC&gt;</span><br><span class="line">cnoremap ;; &lt;ESC&gt;</span><br><span class="line">onoremap ;; &lt;ESC&gt;</span><br><span class="line"></span><br><span class="line">&quot; exit windows</span><br><span class="line">tnoremap ;; &lt;C-\&gt;&lt;C-n&gt;</span><br><span class="line"></span><br><span class="line">&quot; switch windows</span><br><span class="line">nnoremap &lt;TAB&gt; &lt;C-w&gt;w</span><br><span class="line">nnoremap vv &lt;C-v&gt;</span><br><span class="line"></span><br><span class="line">echo expand(&quot;%:p:h&quot;)</span><br><span class="line"></span><br><span class="line">cnoreabbrev fd echo expand(&quot;%:p:h&quot;)</span><br><span class="line">cnoreabbrev vst vs&lt;ENTER&gt;:term</span><br><span class="line">cnoreabbrev spt sp&lt;ENTER&gt;:term</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&quot; -------------------------------------------------------------------------------------------------------------</span><br><span class="line">&quot;-----------------------------------------------common-end----------------------------------------------------</span><br><span class="line">&quot;-------------------------------------------------------------------------------------------------------------</span><br><span class="line">&quot;</span><br><span class="line">&quot;</span><br><span class="line">&quot;</span><br><span class="line">&quot;-------------------------------------------------------------------------------------------------------------</span><br><span class="line">&quot;--------------------------------------------vim-plug-start---------------------------------------------------</span><br><span class="line">&quot;-------------------------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">call plug#begin(&#x27;/home/asleep/.local/share/nvim/site/autoload&#x27;)</span><br><span class="line">Plug &#x27;itchyny/lightline.vim&#x27;</span><br><span class="line">Plug &#x27;joshdick/onedark.vim&#x27;</span><br><span class="line">Plug &#x27;neoclide/coc.nvim&#x27;, &#123;&#x27;branch&#x27;: &#x27;release&#x27;&#125;</span><br><span class="line">Plug &#x27;jiangmiao/auto-pairs&#x27;</span><br><span class="line">Plug &#x27;ms-jpq/chadtree&#x27;, &#123;&#x27;branch&#x27;: &#x27;chad&#x27;, &#x27;do&#x27;: &#x27;python3 -m chadtree deps&#x27;&#125;</span><br><span class="line">Plug &#x27;sheerun/vim-polyglot&#x27;</span><br><span class="line">Plug &#x27;Yggdroot/LeaderF&#x27;, &#123; &#x27;do&#x27;: &#x27;:LeaderfInstallCExtension&#x27; &#125;</span><br><span class="line">Plug &#x27;tpope/vim-fugitive&#x27;</span><br><span class="line">Plug &#x27;sbdchd/neoformat&#x27;</span><br><span class="line">Plug &#x27;iamcco/markdown-preview.nvim&#x27;, &#123; &#x27;do&#x27;: &#x27;cd app &amp;&amp; yarn install&#x27; &#125;</span><br><span class="line">call plug#end()</span><br><span class="line"></span><br><span class="line">&quot;有些插件需要安装 nerd fonts！</span><br><span class="line">&quot;nerd fonts 包括了 powerline fonts！</span><br><span class="line">&quot;建议安装 DejaVuSansMonoNerd！</span><br><span class="line"></span><br><span class="line">&quot;这个是 LeaderF 的设置</span><br><span class="line">let g:Lf_WindowPosition = &#x27;popup&#x27;</span><br><span class="line">cnoreabbrev ff LeaderfFile</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cnoreabbrev fm Neoformat</span><br><span class="line"></span><br><span class="line">cnoreabbrev mt MarkdownPreviewToggle</span><br><span class="line">let g:mkdp_theme = &quot;light&quot;</span><br><span class="line"></span><br><span class="line">&quot;这个是 chadtree 的设置</span><br><span class="line">&quot;明确指定绑定的键之后，就不会使用默认的键</span><br><span class="line">let g:chadtree_settings = &#123;</span><br><span class="line">  \ &#x27;keymap.change_focus_up&#x27;: [&quot;..&quot;],</span><br><span class="line">  \ &#x27;keymap.secondary&#x27;: [&quot;&lt;2-leftmouse&gt;&quot;]</span><br><span class="line">\&#125;</span><br><span class="line"></span><br><span class="line">nnoremap &lt;F2&gt; :CHADopen&lt;CR&gt;</span><br><span class="line"></span><br><span class="line">let g:onedark_terminal_italics=1</span><br><span class="line">autocmd ColorScheme * highlight Normal ctermbg=NONE guibg=NONE </span><br><span class="line">colorscheme onedark</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">let g:lightline = &#123;</span><br><span class="line">      \&#x27;colorscheme&#x27; : &#x27;onedark&#x27;,</span><br><span class="line">      \ &#x27;separator&#x27;: &#123; &#x27;left&#x27;: &#x27;&#x27;, &#x27;right&#x27;: &#x27;&#x27; &#125;,</span><br><span class="line">      \ &#x27;subseparator&#x27;: &#123; &#x27;left&#x27;: &#x27;&#x27;, &#x27;right&#x27;: &#x27;&#x27; &#125;,</span><br><span class="line">      \ &#x27;component&#x27;: &#123;</span><br><span class="line">            \ &#x27;lineinfo&#x27;: &#x27; %3l / %L : %-2v&#x27;,</span><br><span class="line">            \ &#125;, </span><br><span class="line">      \ &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&quot;-------------------------------------------------------------------------------------------------------------</span><br><span class="line">&quot;-----------------------------------------------vim-plug-end--------------------------------------------------</span><br><span class="line">&quot;-------------------------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&quot;-------------------------------------------------------------------------------------------------------------</span><br><span class="line">&quot;------------------------------------------------coc-start----------------------------------------------------</span><br><span class="line">&quot;-------------------------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">inoremap &lt;silent&gt;&lt;expr&gt; &lt;TAB&gt; coc#pum#visible() ? coc#pum#next(1) :&quot;\&lt;Tab&gt;&quot; </span><br><span class="line"></span><br><span class="line">nnoremap gd &lt;Plug&gt;(coc-definition)</span><br><span class="line">nnoremap gt &lt;Plug&gt;(coc-type-definition)</span><br><span class="line">nnoremap gi &lt;Plug&gt;(coc-implementation)</span><br><span class="line">nnoremap gr &lt;Plug&gt;(coc-references)</span><br><span class="line"></span><br><span class="line">&quot; Use K to show documentation in preview window.</span><br><span class="line">function! ShowDocumentation()</span><br><span class="line">  if CocAction(&#x27;hasProvider&#x27;, &#x27;hover&#x27;)</span><br><span class="line">    call CocActionAsync(&#x27;doHover&#x27;)</span><br><span class="line">  else</span><br><span class="line">    call feedkeys(&#x27;K&#x27;, &#x27;in&#x27;)</span><br><span class="line">  endif</span><br><span class="line">endfunction</span><br><span class="line">nnoremap &lt;silent&gt; K :call ShowDocumentation()&lt;CR&gt;</span><br><span class="line"></span><br><span class="line">&quot; Highlight the symbol and its references when holding the cursor.</span><br><span class="line">autocmd CursorHold * silent call CocActionAsync(&#x27;highlight&#x27;)</span><br><span class="line"></span><br><span class="line">&quot; Symbol renaming.</span><br><span class="line">nnoremap &lt;space&gt;r &lt;Plug&gt;(coc-rename)</span><br><span class="line"></span><br><span class="line">&quot; Show all diagnostics.</span><br><span class="line">nnoremap &lt;silent&gt;&lt;nowait&gt; &lt;space&gt;a  :&lt;C-u&gt;CocList diagnostics&lt;cr&gt;</span><br><span class="line"></span><br><span class="line">&quot; Manage extensions.</span><br><span class="line">nnoremap &lt;silent&gt;&lt;nowait&gt; &lt;space&gt;e  :&lt;C-u&gt;CocList extensions&lt;cr&gt;</span><br><span class="line"></span><br><span class="line">&quot; Find symbol of current document.</span><br><span class="line">nnoremap &lt;silent&gt;&lt;nowait&gt; &lt;space&gt;o  :&lt;C-u&gt;CocList outline&lt;cr&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&quot;-------------------------------------------------------------------------------------------------------------</span><br><span class="line">&quot;-------------------------------------------------coc-end-----------------------------------------------------</span><br><span class="line">&quot;-------------------------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><h3 id="init-vim-未启用的配置"><a href="#init-vim-未启用的配置" class="headerlink" title="init.vim 未启用的配置"></a>init.vim 未启用的配置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;-------------------------------------------------------------------------------------------------------------</span><br><span class="line">&quot;&quot;----------------------------------------------netrw_start----------------------------------------------------</span><br><span class="line">&quot;&quot;-------------------------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&quot;&quot;</span><br><span class="line">&quot;&quot;let g:netrw_banner = 0</span><br><span class="line">&quot;&quot;let g:netrw_liststyle = 3</span><br><span class="line">&quot;&quot;let g:netrw_browse_split = 4</span><br><span class="line">&quot;&quot;let g:netrw_altv = 1</span><br><span class="line">&quot;&quot;let g:netrw_winsize = 15</span><br><span class="line">&quot;&quot;</span><br><span class="line">&quot;&quot;set autochdir</span><br><span class="line">&quot;&quot;</span><br><span class="line">&quot;&quot;&quot; Toggle Vexplore with &lt;F2&gt;</span><br><span class="line">&quot;&quot;function! ToggleVExplorer()</span><br><span class="line">&quot;&quot;    if exists(&quot;t:expl_buf_num&quot;)</span><br><span class="line">&quot;&quot;        let expl_win_num = bufwinnr(t:expl_buf_num)</span><br><span class="line">&quot;&quot;        let cur_win_num = winnr()</span><br><span class="line">&quot;&quot;</span><br><span class="line">&quot;&quot;        if expl_win_num != -1</span><br><span class="line">&quot;&quot;            while expl_win_num != cur_win_num</span><br><span class="line">&quot;&quot;                exec &quot;wincmd w&quot;</span><br><span class="line">&quot;&quot;                let cur_win_num = winnr()</span><br><span class="line">&quot;&quot;            endwhile</span><br><span class="line">&quot;&quot;</span><br><span class="line">&quot;&quot;            close</span><br><span class="line">&quot;&quot;        endif</span><br><span class="line">&quot;&quot;</span><br><span class="line">&quot;&quot;        unlet t:expl_buf_num</span><br><span class="line">&quot;&quot;    else</span><br><span class="line">&quot;&quot;         Vexplore</span><br><span class="line">&quot;&quot;         let t:expl_buf_num = bufnr(&quot;%&quot;)</span><br><span class="line">&quot;&quot;    endif</span><br><span class="line">&quot;&quot;endfunction</span><br><span class="line">&quot;&quot;</span><br><span class="line">&quot;&quot;map &lt;F2&gt; :call ToggleVExplorer()&lt;CR&gt;</span><br><span class="line">&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&quot;&quot; 状态栏无插件设置</span><br><span class="line">&quot;&quot;hi VertSplit ctermfg=NONE ctermbg=NONE cterm=NONE</span><br><span class="line">&quot;&quot;set fillchars=vert:\ </span><br><span class="line">&quot;&quot;&quot;&quot;set fillchars=vert:\│</span><br><span class="line">&quot;&quot;set statusline=%*\ %.50F\               &quot;显示文件名和文件路径</span><br><span class="line">&quot;&quot;set statusline+=%=%y%m%r%h%w\ %*        &quot;显示文件类型及文件状态</span><br><span class="line">&quot;&quot;set statusline+=%&#123;&amp;ff&#125;\[%&#123;&amp;fenc&#125;]\ %*   &quot;显示文件编码类型</span><br><span class="line">&quot;&quot;set statusline+=%l/%L,%c\ %*            &quot;显示光标所在行和列</span><br><span class="line">&quot;&quot;set statusline+=%3p%%                   &quot;显示光标前文本所占总文本的比例</span><br><span class="line">&quot;&quot;</span><br><span class="line">&quot;&quot;</span><br><span class="line">&quot;&quot;hi Statusline ctermfg=NONE ctermbg=NONE cterm=bold </span><br><span class="line">&quot;&quot;hi StatuslineNC ctermfg=NONE ctermbg=NONE cterm=NONE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&quot;&quot;-------------------------------------------------------------------------------------------------------------</span><br><span class="line">&quot;&quot;-----------------------------------------------netrw-end-----------------------------------------------------</span><br><span class="line">&quot;&quot;-------------------------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> VIM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MARO VM 调度</title>
      <link href="/2022/10/27/MARO-VM-%E8%B0%83%E5%BA%A6/"/>
      <url>/2022/10/27/MARO-VM-%E8%B0%83%E5%BA%A6/</url>
      
        <content type="html"><![CDATA[<h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><ul><li>在云服务期间，用户请求具有一定数量资源的 <strong>虚拟机（VM）（Virtual Mechine）</strong>，例如中央处理器、内存等</li><li>假设一个特定的时间，VM 请求的数量和到达模式是固定的，给定一个物理资源有限的 <strong>物理机（PM）（Physical Mechine）</strong> 集群</li><li>不同的 VM 分配策略导致数据中心的成功完成量不同，运营成本也不同</li><li>对于云提供商，一个好的 VM 分配策略可以最大限度地提高资源利用率，从而可以通过向用户提供更多的 VM 来增加利润</li><li>对于云用户，良好的 VM 分配策略可以最大程度地缩短 VM 响应时间，并提供更好的使用体验</li></ul><h6 id=""><a href="#" class="headerlink" title=""></a></h6><h3 id="资源供需"><a href="#资源供需" class="headerlink" title="资源供需"></a>资源供需</h3><img src="/pictures/maro-vm-调度/2022.10.27.20.00.43.png"/><ul><li><p>每个 <strong>PM</strong> 中的物理资源是中心资源，包括 <strong>物理内核</strong> 和 <strong>内存</strong></p><ul><li>VM 请求需要一定数量的 <strong>物理资源</strong> ，资源要求因不同的 VM 请求而异 </li><li>只要指定的 PM 的剩余资源足够，<strong>模拟器</strong> 就会将 VM 分配到指定 PM ，VM 会在指定 PM 中创建 </li><li>VM 的资源利用率动态变化，PM 的实时能耗将在 <strong>Runtime-Simulation（模拟器）</strong> 中被模拟出来</li><li>VM 执行一段时间后完成其任务，<strong>模拟器</strong> 将释放分配给此 VM 的资源，并从 PM 中解除分配此 VM ，物理资源被释放，可以处理下一个 VM 请求</li></ul></li></ul><img src="/pictures/maro-vm-调度/2022.10.28.15.14.52.png"/><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><h3 id="VM-Request"><a href="#VM-Request" class="headerlink" title="VM Request"></a>VM Request</h3><ul><li>MARO 和机器学习算法原理类似，需要 <strong>样本数据</strong> 训练出 <strong>模型（找出当前场景的规律）</strong>，再通过模型去 <strong>预测</strong> 怎样的行为更加正确符合实际</li><li>VM scheduling 场景里面，<strong>样本数据</strong> 是 VM Request<strong>s</strong> ，样本数据从实际工作负荷中统一采样</li><li>只要原始数据集足够大，采样率不太小，采样的 VM Requests<strong>（复数名词）</strong> 就可以被认为遵循与原始请求类似的分布</li><li>一个 VM Request 包含 <strong>VM 信息</strong>（如 订阅 ID、部署 ID 和 VM 类别）、<strong>VM 的所需资源</strong>（包括所需的 CPU 核心数和内存）以及 <strong>剩余缓冲时间（remaining buffer time）</strong></li></ul><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><h3 id="VM-类型"><a href="#VM-类型" class="headerlink" title="VM 类型"></a>VM 类型</h3><ul><li><p>交互式</p><ul><li>交互式 VM 通常需要较低的响应时间，因此设置此类 VM 只能分配给不可超额订阅的 PM 服务器</li></ul></li></ul><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><ul><li><p>延迟不敏感</p><ul><li>不区分延迟的 VM 通常用于批处理任务或开发工作负荷，可以将此类 VM 分配给可过度订阅的 PM 服务器</li></ul></li></ul><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><h3 id="VM-分配"><a href="#VM-分配" class="headerlink" title="VM 分配"></a>VM 分配</h3><ul><li><p>根据 <strong>有效的 PM 列表</strong> ，<strong>模拟器记录的历史信息</strong> 以及 <strong>VM 的详细所需资源</strong> ，<strong>VM 调度器（决策代理）</strong> 将根据其分配策略做出决策</p></li><li><p>两种有意义的操作</p><ul><li>将 <strong>有效的 PM ID</strong> 传送到模拟器</li><li>推迟如果 <strong>剩余缓冲区时间</strong> 足够，则可以稍后将处理的 VM Request</li></ul></li></ul><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><h3 id="Oversubscription-超额订阅"><a href="#Oversubscription-超额订阅" class="headerlink" title="Oversubscription 超额订阅"></a>Oversubscription 超额订阅</h3><ul><li><p>考虑到各种服务级别，将物理机分为可超额订阅和非超额订阅的</p></li><li><p>所谓超额，就比如 10 个 VM 实际上只使用 7 个 PM （就是厂商为了省钱）</p></li><li><p>对于超额订阅，可以在 <strong>config.yml</strong> 中设置参数</p></li><li><p>在此场景，有两个资源可能被超额订阅，CPU 和 内存，因可以设置这两个的最大超额订阅率</p><ul><li><p><strong>MAX_CPU_OVERSUBSCRIPTION_RATE</strong> ，CPU 的超额订阅率，默认设置为 1.15 ，意味着每个 PM 最多可以分配其资源容量的 1.15 倍 </p></li><li><p><strong>MAX_MEM_OVERSUBSCRIPTION_RATE</strong> ，内存的超额订阅率，与 CPU 的类似</p></li></ul></li><li><p>为了保护 PM 免受过载的影响，需要考虑 CPU 利用率 ，MAX_UTILIZATION_RATE 被用作安全机制</p><ul><li><strong>MAX_UTILIZATION_RATE</strong> ，默认设置为 1，这意味着在筛选有效 PM 时，允许的最大物理 CPU 使用率为 100%</li></ul></li></ul><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><h3 id="Runtime-Simulation"><a href="#Runtime-Simulation" class="headerlink" title="Runtime Simulation"></a>Runtime Simulation</h3><ul><li><h4 id="动态利用率"><a href="#动态利用率" class="headerlink" title="动态利用率"></a>动态利用率</h4><ul><li>为了使模拟环境最接近真实情况，MARO 模拟每个 VM 的资源利用率（当前仅为 CPU 利用率）</li><li><strong>模拟的</strong> VM CPU 利用率根据<strong>实际的</strong> VM 工作负载读数而变化</li><li>MARO 还将根据每个 PM 中的<strong>实时</strong> VM 定期更新<strong>实时</strong>资源利用率</li></ul></li><li><h4 id="实时能耗"><a href="#实时能耗" class="headerlink" title="实时能耗"></a>实时能耗</h4><ul><li><p>不同的 VM 分配会导致 PM 集群的能耗不同，MARO 还根据 CPU 利用率模拟（计算）能耗</p><ul><li><p>能耗曲线</p><ul><li>这个非线性曲线反映了 CPU 利用率 与 能耗 的关系，用于模拟（计算）能耗</li></ul></li></ul></li></ul>  <img src="/pictures/maro-vm-调度/vm.energy_curve.svg"/></li></ul><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><h3 id="Overload"><a href="#Overload" class="headerlink" title="Overload"></a>Overload</h3><ul><li><p>由于 VM 的 CPU 使用率随时间而变化，因此在启用超额订阅时，VM 的 CPU 使用率之和可能会超过物理资源的容量，这种情况称为过载</p><ul><li><p>目前对于过载的情况，MARO 只支持<strong>静默（杀死）所有虚拟机</strong> 或 <strong>仅记录过载时间</strong>，在 config.yml 里面设置</p><ul><li><p><strong>KILL_ALL_VMS_IF_OVERLOAD</strong> </p><ul><li>如果启用此操作，则一旦发生重载，将解除分配位于重载 PM 的<strong>所有</strong> VM</li><li>考虑到过载的影响，MARO 仍然会计算高利用率的能耗，静默行动对 PM 利用率的影响将反映在下一次 tick 中</li></ul></li></ul></li></ul></li></ul><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><ul><li>无论是否启用终止所有 VM，过载 PM 的数量和过载 VM 的数量都会被计算</li><li>这两个指标是累积值，将被记录为环境指标</li></ul><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><h3 id="VM-解除分配"><a href="#VM-解除分配" class="headerlink" title="VM 解除分配"></a>VM 解除分配</h3><ul><li>MARO 模拟器会定期检查每次 tick 中完成任务的虚拟机</li><li>完成的 VM 意味着它经历了一个完整的生命周期，已准备好终止，它所占用的资源最终将再次可用</li><li>然后，模拟器将释放已完成的 VM 的资源，并最终从 PM 中删除 VM</li></ul><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6><h3 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h3><ul><li><p>准备两个 csv 文件 vm_table 和 cpu_readings_file</p><ul><li><p>vm_table</p><ul><li><p><strong>vm_id</strong>:       int, 每个 vm 的id</p></li><li><p><strong>sub_id</strong>:      int, subscription id（每个 vm 的订阅 id）</p></li><li><p><strong>deploy_id</strong>:   int, 每个 vm 的部署 id</p></li><li><p><strong>timestamp</strong>:   int, 每个 vm 的创建时间</p></li><li><p><strong>vm_deleted</strong>:  int. 每个 vm 的删除时间</p></li><li><p><strong>vm_lifetime</strong>: int, 每个 vm 的生存时间，Lifetime &#x3D; deletion time - creation time (timestamp) + 1</p></li><li><p><strong>vm_category</strong>: int, 目前有三种类型</p><ul><li><p>Delay-Insensitive</p><ul><li>可能延迟的 VM 工作负荷，例如批处理任务或测试工作负荷</li><li>可以将此类 VM 分配给可过度订阅的 PM</li></ul></li><li><p>Interactive</p><ul><li>交互式 VM 工作负荷，需要用户及时响应</li><li>此类 VM 只能分配给不可超额订阅的 PM</li></ul></li><li><p>Unknown</p><ul><li>未知类型</li><li>为避免过载，此类 VM 被视为交互式 VM，只能分配给不可超额订阅的 PM</li></ul></li></ul></li></ul></li><li><p>cpu_readings_file </p><ul><li><strong>timestamp</strong>:   int, 与 vm_table 中的 timestamp 匹配</li><li><strong>vm_id</strong>: int, 与 vm_table 中的 vm_id 匹配</li><li><strong>cpu_utilization</strong>: float, VM CPU 的利用率，以百分比单位 （%）存储</li></ul></li></ul></li></ul><h6 id="-11"><a href="#-11" class="headerlink" title=""></a></h6><h3 id="构建命令"><a href="#构建命令" class="headerlink" title="构建命令"></a>构建命令</h3><ul><li><p>将 CSV 数据集构建为 MARO 模拟器可以使用的二进制文件</p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># maro data build --meta $PATH_TO_META_FILE --file $PATH_TO_CSV_FILE  --output $PATH_TO_OUTPUT_FILE</span><br><span class="line">maro data build --meta ~/.maro/data/vm_scheduling/meta/vmtable.yml  --file ~/.maro/data/vm_scheduling/.build/azure.2019.10k/vmtable.bin --output $PWD/vmtable.bin</span><br></pre></td></tr></table></figure><ul><li><p>–meta：必需，用于指定 meta file 的路径。默认情况下，meta file 位于</p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/.maro/data/vm_scheduling/meta/</span><br></pre></td></tr></table></figure></li><li><p>–file：必需，用于指定源 CSV 数据文件的路径，如果需要多个源 CSV 数据文件，则可以在特定文件中列出源文件的所有完整路径，并使用 @ 符号指定这个特定文件</p></li><li><p>–output：必需，用于指定目标二进制文件的路径</p></li></ul></li><li><p>生成二进制文件之后，在 topologies 目录下的 config.yml 中指定 VM_TABLE 和 CPU_READINGS 的直接路径</p></li></ul><h6 id="-12"><a href="#-12" class="headerlink" title=""></a></h6><h3 id="Environment-Interface"><a href="#Environment-Interface" class="headerlink" title="Environment Interface"></a>Environment Interface</h3><ul><li><h4 id="DecisionPayload"><a href="#DecisionPayload" class="headerlink" title="DecisionPayload"></a>DecisionPayload</h4><ul><li><p>一旦环境需要代理的响应来促进模拟，它就会抛出一个带有 DecisionPayload 的 PendingDecision 事件</p></li><li><p>DecisionPayload 包含以下信息</p><ul><li><strong>valid_pms (List[int])</strong> ：被视为有效的 PM ID 列表（其 CPU 和内存资源足以满足传入的 VM 请求） </li><li><strong>vm_id (int)</strong> ：传入的 VM Request（正在等待分配的 VM Request）的 vm_id ，</li><li><strong>vm_cpu_cores_requirement (int)</strong> ：传入的 VM Request 的 CPU 内核数量</li><li><strong>vm_memory_requirement (int)</strong> ：传入的 VM Request 请求的内存资源大小</li><li><strong>remaining_buffer_time（int）</strong> ：当使用 remaining_buffer_time 时，VM Request 将被视为失败，可以在 config.yml 里面设置</li></ul></li></ul></li><li><h4 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h4><ul><li><p>从环境中获取 PendingDecisionAction 事件后，代理应使用 Action 进行响应，以下是有效的 Action</p><ul><li><p><strong>None</strong>：除了忽略此 VM Request 之外什么都不执行</p></li><li><p><strong>AllocateAction</strong>：VM 的创建时间将固定在它收到这个 Request 的 tick 处，模拟器将更新目标 PM 的工作负载（CPU 核心数量，内存和能耗），这个 Action 包括:</p><ul><li>**vm_id(int)**：等待分配资源的 VM 的 ID</li><li>**pm_id(int)**：计划将 VM 分配到的 PM 的 ID</li></ul></li><li><p><strong>PostponeAction</strong>：计算 remaining buffer time，这个 Action 包括：</p><ul><li><strong>vm_id (int)</strong> ：等待分配的 VM 的 ID</li><li><strong>postpone_step（int）</strong>：分配要推迟的次数，单位是 DELAY_DURATION ，1 表示延迟 1 DELAY_DURATION ，可以在 config.yml 中设置</li><li>如果时间仍然足够，模拟器将重新生成一个新的请求事件，新需求事件的 仅在剩余缓冲时间上与旧事件不同</li><li>如果时间用完，模拟器会将其记录为失败的分配</li></ul></li></ul></li></ul></li></ul><h6 id="-13"><a href="#-13" class="headerlink" title=""></a></h6><h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">import random</span><br><span class="line"></span><br><span class="line">from maro.simulator import Env</span><br><span class="line">from maro.simulator.scenarios.vm_scheduling import AllocateAction, DecisionPayload, PostponeAction</span><br><span class="line"></span><br><span class="line"># Initialize an Env for vm_scheduling scenario</span><br><span class="line"># 初始化环境</span><br><span class="line">env = Env(</span><br><span class="line">  scenario=&quot;vm_scheduling&quot;,     </span><br><span class="line">  topology=&quot;azure.2019.10k&quot;,    </span><br><span class="line">  start_tick=0,                </span><br><span class="line">  durations=8638,              </span><br><span class="line">  snapshot_resolution=1</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"># 初始化变量，声明类型，&quot;:&quot;用于声明类型</span><br><span class="line">metrics: object = None</span><br><span class="line">decision_event: DecisionPayload = None</span><br><span class="line">is_done: bool = False</span><br><span class="line">action: AllocateAction = None</span><br><span class="line"></span><br><span class="line"># Start the env with a None Action</span><br><span class="line"># 开始模拟</span><br><span class="line">metrics, decision_event, is_done = env.step(None)</span><br><span class="line"></span><br><span class="line">while not is_done:</span><br><span class="line">    valid_pm_num: int = len(decision_event.valid_pms)</span><br><span class="line"># 作出决策</span><br><span class="line">    if valid_pm_num &lt;= 0:</span><br><span class="line">        # No valid PM now, postpone.</span><br><span class="line"># 没有可用的 PM ，推迟分配</span><br><span class="line">        action: PostponeAction = PostponeAction(</span><br><span class="line">            vm_id=decision_event.vm_id,</span><br><span class="line">            postpone_step=1</span><br><span class="line">        )</span><br><span class="line">    else:</span><br><span class="line">        # Randomly choose an available PM.</span><br><span class="line"># 有可用的 PM ，随机选一个 PM 与 VM 绑定</span><br><span class="line">        random_idx = random.randint(0, valid_pm_num - 1)</span><br><span class="line">        pm_id = decision_event.valid_pms[random_idx]</span><br><span class="line">        action: AllocateAction = AllocateAction(</span><br><span class="line">            vm_id=decision_event.vm_id,</span><br><span class="line">            pm_id=pm_id</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line"># 采取行动</span><br><span class="line">    metrics, decision_event, is_done = env.step(action)</span><br><span class="line"></span><br><span class="line">print(f&quot;[Random] Topology: azure.2019.10k. Total ticks: 8638. Start tick: 0&quot;)</span><br><span class="line">print(metrics)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> MARO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工作面试</title>
      <link href="/2022/10/26/%E5%B7%A5%E4%BD%9C%E9%9D%A2%E8%AF%95/"/>
      <url>/2022/10/26/%E5%B7%A5%E4%BD%9C%E9%9D%A2%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h4 id="深信服-Go-后端笔试-实习-2022-9-29"><a href="#深信服-Go-后端笔试-实习-2022-9-29" class="headerlink" title="深信服 Go 后端笔试(实习) 2022.9.29"></a>深信服 Go 后端笔试(实习) 2022.9.29</h4><ul><li>牛客，要求录屏</li><li>Go 语言基本语法（非常细节）</li><li>算法 编辑距离</li></ul><h4 id="字节飞书搜索后端一面-实习-2022-10-11"><a href="#字节飞书搜索后端一面-实习-2022-10-11" class="headerlink" title="字节飞书搜索后端一面(实习) 2022.10.11"></a>字节飞书搜索后端一面(实习) 2022.10.11</h4><ul><li>飞书浏览器或者客户端面试</li><li>自我介绍</li><li>简历内容（项目过程里面遇到什么问题，如何解决)</li><li>为什么选择字节</li><li>为什么选择 Go 语言</li><li>Python 为什么比 Go 效率低下</li><li>Go 语言 sync 包的数据结构以及函数用过哪些</li><li>Go 语言逃逸分析</li><li>Go 内存管理</li><li>什么是线程安全</li><li>redis 如何实现线程安全</li><li>你写的 redis 是线程安全的吗</li><li>redis 实现原理</li><li>算法 对称二叉树（感觉有点羞辱）</li><li>C++ 现在最新标准，有什么新特性</li></ul><h4 id="海能达-Go-后端笔试一面-实习-2022-10-18"><a href="#海能达-Go-后端笔试一面-实习-2022-10-18" class="headerlink" title="海能达 Go 后端笔试一面(实习) 2022.10.18"></a>海能达 Go 后端笔试一面(实习) 2022.10.18</h4><ul><li>腾讯会议</li><li>自我介绍</li><li>Go 的切片数组区别</li><li>为什么大三就来面试</li><li>简历内容（项目过程里面遇到什么问题，如何解决)</li><li>软件工程</li><li>软件开发流程</li><li>软件设计模式</li><li>影响数据库查询速率的因素</li></ul><h4 id="腾讯游戏技术运营一面-实习-2022-10-25"><a href="#腾讯游戏技术运营一面-实习-2022-10-25" class="headerlink" title="腾讯游戏技术运营一面(实习) 2022.10.25"></a>腾讯游戏技术运营一面(实习) 2022.10.25</h4><ul><li><p>腾讯会议面试，要求录屏</p></li><li><p>先来做几条题目，很简单，主要看思路，但是基本语法不能错误，任意语言</p><ul><li>使用 js&#x2F;php&#x2F;python 自行实现函数方法 去掉一个数组的重复元素，例如：let arr &#x3D; [1 ,1 ,2, 3, 3, 2, 1] (若是百亿数据，要求时间O(n)，空间O(1)，有什么思路)</li><li>使用 js&#x2F;php&#x2F;python 实现一个函数，将字符串 “hello_world” 转换成 “HelloWorld” , “hello_hang_zhou” 转换成 “HelloHangZhou” (注意：通用性)</li><li>使用 js&#x2F;php&#x2F;python 实现一个函数方法，参数为输入一个整数，然后输出这个数所有的因数以及总的个数，比如参数传 48 ，此时输出 1、2、3、4、6、8、12、16、24、48 共 10 个数字，比如参数传 21 ，此时输出 1、3、7、21 共 4 个数字</li><li>使用 js&#x2F;php&#x2F;python 函数遍历以下 json 数据，输出指定格式结果（考虑 children 层次会无限嵌套）</li><li>数据库操作，建一个表学生 student (id,name,sex,birth) (编号、姓名、性别、出生年月)<ul><li>写下建表语句：</li><li>student 表新增一个字段“班级编号”（class_no），写出对应的执行 sql 语句</li><li>统计每个班级有多少个学生，根据班级编号统计，写下统计 sql</li></ul></li></ul></li><li><p>自我介绍</p></li><li><p>问简历的内容</p></li><li><p>redis 五种数据类型</p></li><li><p>平时喜欢看什么书（简历有写）</p></li><li><p>bash 基本知识</p></li><li><p>面向对象三大特性</p></li><li><p>数据库三大特性深入理解</p></li><li><p>sql 备份主从一致</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> 工作面试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo 加强 Next Theme 美化</title>
      <link href="/2022/10/26/Hexo-%E5%8A%A0%E5%BC%BA-Next-Theme-%E7%BE%8E%E5%8C%96/"/>
      <url>/2022/10/26/Hexo-%E5%8A%A0%E5%BC%BA-Next-Theme-%E7%BE%8E%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h4 id="Hexo-Next-主题"><a href="#Hexo-Next-主题" class="headerlink" title="Hexo-Next 主题"></a>Hexo-Next 主题</h4><p>hexo-theme-next 应该是目前最广泛使用的hexo主题</p><h4 id="安装-Hexo-Next-主题"><a href="#安装-Hexo-Next-主题" class="headerlink" title="安装 Hexo-Next 主题"></a>安装 Hexo-Next 主题</h4><p>切换到你的博客顶级工程目录，npm 安装</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-theme-next</span><br></pre></td></tr></table></figure><h4 id="切换到-Next-主题"><a href="#切换到-Next-主题" class="headerlink" title="切换到 Next 主题"></a>切换到 Next 主题</h4><p>在你的博客顶层工程目录下打开 “_config.yml”</p><img src="/pictures/hexo-next-theme-美化/2022.10.26.13.24.11.png"/><p>搜索themes，将里面的值改为next</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">theme: next</span><br></pre></td></tr></table></figure><h4 id="配置-Next-主题"><a href="#配置-Next-主题" class="headerlink" title="配置 Next 主题"></a>配置 Next 主题</h4><p>将 node_modules&#x2F;hexo-theme-next&#x2F;_config.yml 复制到博客顶层文件目录，重命名为 “_config.next.yml”</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd your_site_dir</span><br><span class="line">cp node_modules/hexo-theme-next/_config.yml  _config.next.yml</span><br></pre></td></tr></table></figure><ul><li><h5 id="选择-Schemes"><a href="#选择-Schemes" class="headerlink" title="选择 Schemes"></a>选择 Schemes</h5><p>  打开 “_config.next.yml” ，首先可以看到 Scheme Settings ，里面提供了四种模式，本站使用 Mist 主题</p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Schemes</span><br><span class="line">#scheme: Muse</span><br><span class="line">scheme: Mist</span><br><span class="line">#scheme: Pisces</span><br><span class="line">#scheme: Gemini</span><br></pre></td></tr></table></figure></li><li><h5 id="设置站点-icon"><a href="#设置站点-icon" class="headerlink" title="设置站点 icon"></a>设置站点 icon</h5><p>  在 favicon 中，可以设置侧边栏头像以及站点 icon ，需要把你的 icon 放在主题目录的 source&#x2F;img&#x2F; 目录下</p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">favicon:</span><br><span class="line">     small: /img/avatar.jfif</span><br><span class="line">     medium: /img/avatar.jfif</span><br><span class="line">     apple_touch_icon: /img/avatar.jfif</span><br><span class="line">     safari_pinned_tab: /images/logo.svg</span><br></pre></td></tr></table></figure></li><li><h5 id="还有其余的很多配置，可以参考-“-config-next-yml”-里面的提示来配置"><a href="#还有其余的很多配置，可以参考-“-config-next-yml”-里面的提示来配置" class="headerlink" title="还有其余的很多配置，可以参考 “_config.next.yml” 里面的提示来配置"></a>还有其余的很多配置，可以参考 “_config.next.yml” 里面的提示来配置</h5></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>初识 MARO</title>
      <link href="/2022/10/26/%E5%88%9D%E8%AF%86-MARO/"/>
      <url>/2022/10/26/%E5%88%9D%E8%AF%86-MARO/</url>
      
        <content type="html"><![CDATA[<h3 id="MARO-，“Multi-Agent-Resource-Optimization”-，中文是“多代理资源优化”-，使用强化学习来解决资源调度的一个平台"><a href="#MARO-，“Multi-Agent-Resource-Optimization”-，中文是“多代理资源优化”-，使用强化学习来解决资源调度的一个平台" class="headerlink" title="MARO ，“Multi-Agent-Resource Optimization” ，中文是“多代理资源优化” ，使用强化学习来解决资源调度的一个平台"></a><a href="https://github.com/microsoft/maro">MARO ，“Multi-Agent-Resource Optimization” </a>，中文是“多代理资源优化” ，使用强化学习来解决资源调度的一个平台</h3><h6 id=""><a href="#" class="headerlink" title=""></a></h6><h4 id="可以应用-MARO-的实际例子："><a href="#可以应用-MARO-的实际例子：" class="headerlink" title="可以应用 MARO 的实际例子："></a>可以应用 MARO 的实际例子：</h4><ul><li><h5 id="CIM-”Container-Inventory-Management”-中文是“集装箱库存管理”。全球贸易里面会有很多港口，但是每个港口需要的空集装箱都不一样，有的港口可能空集装箱是剩余的（比如进口向港口），有的港口可能空集装箱不够（比如出口向港口）"><a href="#CIM-”Container-Inventory-Management”-中文是“集装箱库存管理”。全球贸易里面会有很多港口，但是每个港口需要的空集装箱都不一样，有的港口可能空集装箱是剩余的（比如进口向港口），有的港口可能空集装箱不够（比如出口向港口）" class="headerlink" title="CIM,”Container Inventory Management”,中文是“集装箱库存管理”。全球贸易里面会有很多港口，但是每个港口需要的空集装箱都不一样，有的港口可能空集装箱是剩余的（比如进口向港口），有的港口可能空集装箱不够（比如出口向港口）"></a>CIM,”Container Inventory Management”,中文是“集装箱库存管理”。全球贸易里面会有很多港口，但是每个港口需要的空集装箱都不一样，有的港口可能空集装箱是剩余的（比如进口向港口），有的港口可能空集装箱不够（比如出口向港口）</h5><ul><li>而使用 MARO 可以解决这个问题，使得每个港口尽可能分配到恰当的空集装箱资源，不多不少。</li><li>在这个场景里面，空集装箱是中心资源，导致资源数量改变的事件有两个：<ul><li>第一个是 Order ，即订单，订单会导致货物从 source port 运到 destination port ， 这个时候 source port 出货，empty container 会减少，destination port 进货，empty container 会增加</li><li>第二个是 repositioning，使用 MARO 重定位空集装箱，平衡全球空集装箱分布。</li></ul></li></ul></li></ul><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><p><img src="/pictures/%E5%88%9D%E8%AF%86MARO/cim.container_flow.svg"></p><ul><li><h5 id="对上面这个流程图的解释"><a href="#对上面这个流程图的解释" class="headerlink" title="对上面这个流程图的解释"></a>对上面这个流程图的解释</h5><ul><li>托运人（shipper）生成订单（send order）后，相应源端口（source port）的空容器将被释放（release empty）给托运人（shipper）</li><li>托运人（shipper）将用货物装满集装箱，将其变成满载货物，然后在将满载货物的集装箱运回到（return laden）源港口（source port）</li><li>船（vessel）到港口（source port）之后被装载满载货物的集装箱（load laden）</li><li>船航行到进口港（source port），卸货（discharge laden）</li><li>满载货物将被释放（release laden）给收货人（consignee），收货人将取出其中的货物，集装箱再次变空返回港口（return empty）</li></ul></li></ul><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><ul><li><h5 id="这个时候我们发现，整个过程我们还有五个部分没有提到，分别是-agent-，operate-empty-，load-x2F-discharge-empty"><a href="#这个时候我们发现，整个过程我们还有五个部分没有提到，分别是-agent-，operate-empty-，load-x2F-discharge-empty" class="headerlink" title="这个时候我们发现，整个过程我们还有五个部分没有提到，分别是 agent ，operate empty ，load&#x2F;discharge empty"></a>这个时候我们发现，整个过程我们还有五个部分没有提到，分别是 agent ，operate empty ，load&#x2F;discharge empty</h5><ul><li>为了为了重新平衡集装箱分布，每个港口（port）的代理商（agent）将决定每次船舶（vessel）到达港口时如何重新分配（repostioning）空集装箱<ul><li>船只（vessel）到达港口时，是往船上装载空集装箱（load empty），还是消费船上原有的空集装箱（discharge empty）</li><li>分配 load&#x2F;discharge empty 的数量</li></ul></li></ul></li></ul><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><ul><li><h5 id="MARO-就是帮助-agent-调整-load-x2F-discharge-empty-的数量，决策目标不仅要考虑自身未来的供需情况，还要考虑上下游港口的需求和情况"><a href="#MARO-就是帮助-agent-调整-load-x2F-discharge-empty-的数量，决策目标不仅要考虑自身未来的供需情况，还要考虑上下游港口的需求和情况" class="headerlink" title="MARO 就是帮助 agent 调整 load&#x2F;discharge empty 的数量，决策目标不仅要考虑自身未来的供需情况，还要考虑上下游港口的需求和情况"></a>MARO 就是帮助 agent 调整 load&#x2F;discharge empty 的数量，决策目标不仅要考虑自身未来的供需情况，还要考虑上下游港口的需求和情况</h5><ul><li>出口导向型港口（例如中国的港口）显示出明显的高需求特征，通常需要额外的空集装箱供应，这些港口将倾向于从船上卸载空集装箱</li><li>虽然以进口为导向的港口具有显著的盈余特征，但通常从收货人那里收到许多空集装箱，因此，如果存在空闲容量，面向进口的港口将倾向于将多余的空集装箱装入船舶</li></ul></li></ul><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><ul><li><h4 id="简单拓扑结构"><a href="#简单拓扑结构" class="headerlink" title="简单拓扑结构"></a>简单拓扑结构</h4><img src="/pictures/%E5%88%9D%E8%AF%86MARO/cim.toys.svg"></li><li><h5 id="这里要特别注意上面这个图里面，这里的-S-和-D-并不是-source-和-destination，而是-empty-containers-的-supplier-和-demander，这里-order-也并不是货物订单，而是-empty-containers-的订单"><a href="#这里要特别注意上面这个图里面，这里的-S-和-D-并不是-source-和-destination，而是-empty-containers-的-supplier-和-demander，这里-order-也并不是货物订单，而是-empty-containers-的订单" class="headerlink" title="这里要特别注意上面这个图里面，这里的 S 和 D 并不是 source 和 destination，而是 empty containers 的 supplier 和 demander，这里 order 也并不是货物订单，而是 empty containers 的订单"></a>这里要特别注意上面这个图里面，这里的 S 和 D 并不是 source 和 destination，而是 empty containers 的 supplier 和 demander，这里 order 也并不是货物订单，而是 empty containers 的订单</h5></li><li><h5 id="上图实线表示货物流向，虚线表示订单流向，S-与-D-由订单（Order）决定，订单发起方为-D，订单收到方为-S"><a href="#上图实线表示货物流向，虚线表示订单流向，S-与-D-由订单（Order）决定，订单发起方为-D，订单收到方为-S" class="headerlink" title="上图实线表示货物流向，虚线表示订单流向，S 与 D 由订单（Order）决定，订单发起方为 D，订单收到方为 S"></a>上图实线表示货物流向，虚线表示订单流向，S 与 D 由订单（Order）决定，订单发起方为 D，订单收到方为 S</h5><ul><li><strong>拓扑（1）</strong> 有四个 port ，D1 和 D2 是简单的需求者（需要额外 empty container 的端口），而 S2 是简单的供应商（具有剩余空容器的端口），尽管 S1 是一个简单的目标端口，但它位于两个服务路由的交点，这使其成为此拓扑中的特殊端口，为了实现全局最优，S1 必须学会区分服务路由并执行特定于服务路由的重新定位操作</li><li><strong>拓扑（2）</strong> 中有五个端口，根据订单，D1 和 D2 是简单的需求者，而 S1 和 S2 是简单的供应商，作为服务航线交汇处的港口，T1港口虽然可以达到自平衡状态，但仍对全局最优起着重要作用，T1 的最佳重新定位策略是将多余的空容器从左侧服务路由转移到右侧服务路由，此外，D1 和 D2 应该学会只卸载它们需要的 empty 数量，并将多余的 empty 留给其他端口</li><li><strong>拓扑（3）</strong> 中有六个端口，简单的需求者 D1 和 D2 ，简单的供应商 S1 和 S2 ，以及自平衡端口 T1 和 T2 ，比拓扑（2）更困难的是，应该采取更多的转移来将多余的空集装箱从最左边的服务路线重新定位到最右边的航线，这意味着需要一个涉及更多港口的多步骤解决方案</li></ul></li></ul><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><p><img src="/pictures/%E5%88%9D%E8%AF%86MARO/cim.global_trade.svg"></p><ul><li>这是基于真实世界数据设计的拓扑,大多数港口不再具有简单的供需功能。港口之间的合作要复杂得多，很难手动找到有效的重新定位策略</li></ul><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><ul><li><h4 id="入门"><a href="#入门" class="headerlink" title="入门"></a>入门</h4></li><li><h5 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pymaro</span><br></pre></td></tr></table></figure></li><li><h5 id="MARO-算法有两个关键步骤"><a href="#MARO-算法有两个关键步骤" class="headerlink" title="MARO 算法有两个关键步骤"></a>MARO 算法有两个关键步骤</h5></li><li><h6 id="算法决策事件-DecisionEventDecisionEvent"><a href="#算法决策事件-DecisionEventDecisionEvent" class="headerlink" title="算法决策事件 DecisionEventDecisionEvent"></a>算法决策事件 DecisionEventDecisionEvent</h6><ul><li>tick (int)：相应的刻度</li><li>port_idx（int）：需要响应环境的端口&#x2F;代理的 ID</li><li>vessel_idx（int）：港口&#x2F;代理人的船舶&#x2F;操作对象的 ID</li><li>action_scope（操作范围）：操作范围有两个属性，load表示可以从船舶港口装载的最大数量，discharge表示从船舶到港口可以卸货的最大数量</li><li>early_discharge（int）：当船上的可用容量不足以装载满载物时，船上的一些空容器将被提前卸货以释放空间，由于满载而提前卸货的空容器数量记录在该字段中</li></ul></li><li><h6 id="行动-Action"><a href="#行动-Action" class="headerlink" title="行动 Action"></a>行动 Action</h6><ul><li>none，这意味着什么都不做</li><li>a valid instance，有效实例：</li><li>vessel_idx（int）：港口&#x2F;代理人的船舶&#x2F;操作对象的 ID</li><li>port_idx（int）：执行此操作的端口&#x2F;代理的 ID</li><li>action_type（操作类型）：在此操作中是装载还是卸载空容器</li><li>数量（int）：要装载&#x2F;卸载的空容器的（非负）数量</li></ul></li></ul><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><p><img src="/pictures/%E5%88%9D%E8%AF%86MARO/maro_overview.svg"></p><ul><li><h4 id="上图是-MARO-框架图"><a href="#上图是-MARO-框架图" class="headerlink" title="上图是 MARO 框架图"></a>上图是 MARO 框架图</h4><ul><li>Simulation toolkit：它提供了一些预定义的场景，以及用于构建新场景的可重用轮子</li><li>RL toolkit：它为 RL 提供了全栈抽象，例如代理管理器、代理、RL 算法、学习器、参与者和各种塑造者</li><li>Distributed toolkit：提供分布式通信组件、消息自动处理、集群配置、作业编排等用户定义功能的接口</li></ul></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> MARO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo 文档分类 图片存储</title>
      <link href="/2022/10/23/Hexo-%E6%96%87%E6%A1%A3%E5%88%86%E7%B1%BB-%E5%9B%BE%E7%89%87%E5%AD%98%E5%82%A8/"/>
      <url>/2022/10/23/Hexo-%E6%96%87%E6%A1%A3%E5%88%86%E7%B1%BB-%E5%9B%BE%E7%89%87%E5%AD%98%E5%82%A8/</url>
      
        <content type="html"><![CDATA[<p><strong>建立分类</strong></p><ol><li>输入 hexo new page ‘categories’</li></ol><h6 id=""><a href="#" class="headerlink" title=""></a></h6><ol start="2"><li>在顶层工程目录的 source 目录中會看到 categories 文件夹</li></ol><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><ol start="3"><li><p>修改 categories 中的 index.md 开头，增加一些东西使得变成如下内容</p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: categories</span><br><span class="line">date: 2022-10-23 13:30:15</span><br><span class="line">type: &quot;categories&quot;</span><br><span class="line">---</span><br></pre></td></tr></table></figure></li><li><p>若要把 “_post” 內的其中一份文档添加到 “Hexo-Usage” categories 里面，在这个文档头部插入 categories: Hexo-Usage</p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Hexo 基本美化</span><br><span class="line">date: 2022-10-23 16:08:56</span><br><span class="line">categories: Hexo-Usage</span><br><span class="line">---</span><br></pre></td></tr></table></figure></li><li><p>重新生成静态网页，可以看到导航栏多了一个分类选项</p></li></ol><p><img src="/pictures/hexo-%E6%96%87%E6%A1%A3%E5%88%86%E7%B1%BB-%E5%9B%BE%E7%89%87%E5%AD%98%E5%82%A8/2022.10.23.19.31.09.png"></p><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><p><strong>建立标签</strong></p><p>和建立分类一样，只不过内容改变一点</p><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><ol><li>输入 hexo new page ‘tags’</li></ol><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><ol start="2"><li>在顶层工程目录的 source 目录中會看到 tags 文件夹</li></ol><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><ol start="3"><li>修改 tags 中的 index.md 开头，增加一些东西使得变成如下内容 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: tags</span><br><span class="line">date: 2022-10-23 13:35:49</span><br><span class="line">type: &quot;tags&quot;</span><br><span class="line">---</span><br></pre></td></tr></table></figure></li><li>若要把 “_post” 內的其中一份文档添加到 “Hexo” tag 里面，在这个文档头部插入 tags: Hexo <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Hexo 文档分类 图片存储</span><br><span class="line">date: 2022-10-23 19:16:39</span><br><span class="line">categories: Hexo-Usage</span><br><span class="line">tags: Hexo</span><br><span class="line">---</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li>插入多个 tags ，记得 tab 缩进 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Hexo 文档分类 图片存储</span><br><span class="line">date: 2022-10-23 19:16:39</span><br><span class="line">categories: Hexo-Usage</span><br><span class="line">tags:</span><br><span class="line">- Hexo</span><br><span class="line">- Github</span><br><span class="line">---</span><br></pre></td></tr></table></figure></li><li>重新生成静态网页，可以看到导航栏多了一个标签选项</li></ol><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><p><img src="/pictures/hexo-%E6%96%87%E6%A1%A3%E5%88%86%E7%B1%BB-%E5%9B%BE%E7%89%87%E5%AD%98%E5%82%A8/2022.10.23.19.50.12.png"></p><p><strong>文档里面插入图片</strong></p><p>使用Hexo创建文件搭建博客时，会遇到图片插图，以及插入的图片无法显示的问题</p><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><ol><li>在 Hexo 的目录（也就是顶层工程目录） source 中创建一个图片文件夹，例如 pictures</li></ol><p><img src="/pictures/hexo-%E6%96%87%E6%A1%A3%E5%88%86%E7%B1%BB-%E5%9B%BE%E7%89%87%E5%AD%98%E5%82%A8/2022.10.23.19.55.54.png"></p><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><ol start="2"><li><p>把要插入的图片文件放到该目录下面，在文档中正常使用 markdown 的语法插入图片即可，例如</p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![img](ictures/xxx.png)</span><br></pre></td></tr></table></figure></li><li><p>当然，你还可以在 pictures 再创建目录以区分不同文章的图片</p></li></ol><p><img src="/pictures/hexo-%E6%96%87%E6%A1%A3%E5%88%86%E7%B1%BB-%E5%9B%BE%E7%89%87%E5%AD%98%E5%82%A8/2022.10.23.20.00.11.png"></p><ol start="4"><li><p>这个时候在文章里面引用的方式就是</p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![img](ictures/hexo-文档分类-图片存储/xxx.png)</span><br></pre></td></tr></table></figure></li></ol><p>记住在 “pictures” 前面有一个 “&#x2F;“ ，表示根目录的意思，因为对于 hexo 来说它的资源文件的根目录就是 source ，当然也可以修改 “_config.yml” 改变这个配置，下图是 hexo 框架文件夹描述</p><p><img src="/pictures/hexo-%E6%96%87%E6%A1%A3%E5%88%86%E7%B1%BB-%E5%9B%BE%E7%89%87%E5%AD%98%E5%82%A8/20191220164252492.png"></p>]]></content>
      
      
      <categories>
          
          <category> Hexo-Usage </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo 基本美化</title>
      <link href="/2022/10/23/Hexo-%E5%9F%BA%E6%9C%AC%E7%BE%8E%E5%8C%96/"/>
      <url>/2022/10/23/Hexo-%E5%9F%BA%E6%9C%AC%E7%BE%8E%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<p><strong>首先是顶部背景</strong>，下面是原背景</p><p><img src="/pictures/hexo-%E5%9F%BA%E6%9C%AC%E7%BE%8E%E5%8C%96/2022.10.23.16.14.49.png"></p><p>在 blogs 文件夹（顶层工程文件目录）里面搜索 banner.jpg</p><p><img src="/pictures/hexo-%E5%9F%BA%E6%9C%AC%E7%BE%8E%E5%8C%96/2022.10.23.16.17.17.png"></p><p>把这两个 banner.jpg 替换成自己图片，替换之后名字还得是 banner.jpg</p><p><img src="/pictures/hexo-%E5%9F%BA%E6%9C%AC%E7%BE%8E%E5%8C%96/2022.10.23.16.19.21.png"></p><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p><img src="/pictures/hexo-%E5%9F%BA%E6%9C%AC%E7%BE%8E%E5%8C%96/2022.10.23.16.22.22.png"></p><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><p><strong>定义自己的信息</strong>，定义在顶层工程目录的 “_config.yml” 里面</p><p><img src="/pictures/hexo-%E5%9F%BA%E6%9C%AC%E7%BE%8E%E5%8C%96/2022.10.23.16.25.30.png"></p><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><p><img src="/pictures/hexo-%E5%9F%BA%E6%9C%AC%E7%BE%8E%E5%8C%96/2022.10.23.16.27.38.png"></p><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><p><strong>美化代码块</strong>，原本的代码块没有 margin-left 和 margin-right ，不好看<br><img src="/pictures/hexo-%E5%9F%BA%E6%9C%AC%E7%BE%8E%E5%8C%96/2022.10.23.16.29.42.png"></p><p>在顶层工程文件目录里面，搜索 highlight.styl</p><p><img src="/pictures/hexo-%E5%9F%BA%E6%9C%AC%E7%BE%8E%E5%8C%96/2022.10.23.16.32.39.png"></p><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><p><img src="/pictures/hexo-%E5%9F%BA%E6%9C%AC%E7%BE%8E%E5%8C%96/2022.10.23.16.33.18.png"></p><p>这两个 css 文件是一样的，要修改的地方也一样</p><p><img src="/pictures/hexo-%E5%9F%BA%E6%9C%AC%E7%BE%8E%E5%8C%96/2022.10.23.16.35.28.png"></p><p>注释掉原来的 margin ，换成 “margin:1px” 就可以</p><p><img src="/pictures/hexo-%E5%9F%BA%E6%9C%AC%E7%BE%8E%E5%8C%96/2022.10.23.16.36.27.png"></p><p>效果很 nice</p><p><img src="/pictures/hexo-%E5%9F%BA%E6%9C%AC%E7%BE%8E%E5%8C%96/2022.10.23.16.38.27.png"></p><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><p><strong>最终效果</strong></p><p><img src="/pictures/hexo-%E5%9F%BA%E6%9C%AC%E7%BE%8E%E5%8C%96/2022.10.23.16.41.32.png"></p>]]></content>
      
      
      <categories>
          
          <category> Hexo-Usage </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github Pages + Hexo</title>
      <link href="/2022/10/23/Github-Pages+Hexo/"/>
      <url>/2022/10/23/Github-Pages+Hexo/</url>
      
        <content type="html"><![CDATA[<p><strong>Github Pages 可以为个人博客提供支持，Hexo 可以让 Github Pages 更加美观和提供本地预览，而不需要上传到 Github Pages 之后再看到效果</strong></p><h6 id=""><a href="#" class="headerlink" title=""></a></h6><p><strong>安装准备</strong>（本地）：</p><ul><li>git</li><li>npm</li></ul><h6 id="-1"><a href="#-1" class="headerlink" title=""></a></h6><p><strong>配置 Git</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">&quot;github 用户名&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;github 注册邮箱&quot;</span></span><br></pre></td></tr></table></figure><p>Github 已经不支持密码登录，需要复杂一点的步骤去验证</p><h6 id="-2"><a href="#-2" class="headerlink" title=""></a></h6><ol><li>到个人中心-设置-setting</li><li><img src="/pictures/github-pages-hexo/75e96721a3344ed5b397ec8adfeedb98.png"></li><li><img src="/pictures/github-pages-hexo/4eb29e6a9b2c4bf6b2b5db9299b1a393.png"><br><img src="/pictures/github-pages-hexo/3def5390d66a40eab1305013f28383d1.png"></li><li>选 classic 的 token 而不是 beta 的，因为 classic 可以永久</li><li><img src="/pictures/github-pages-hexo/de366346ddf443fba27a2cda84d9593f.png"><br><img src="/pictures/github-pages-hexo/852ef46dcc3d4018bc79fdac2ed8c917.png"></li><li>点击 generate token按钮</li></ol><h6 id="-3"><a href="#-3" class="headerlink" title=""></a></h6><p>然后 生成了token 一定要复制，不然刷新浏览器就没了</p><h6 id="-4"><a href="#-4" class="headerlink" title=""></a></h6><p>拿到token以后再去git push&#x2F;clone ，password就是输入刚才复制的token</p><h6 id="-5"><a href="#-5" class="headerlink" title=""></a></h6><p><strong>Hexo 安装（本地全局）</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo-cli -g</span><br></pre></td></tr></table></figure><p>新建一个文件夹（我的是blogs）用于存放你的博客，然后进入该文件夹，并用如下命令进行初始化并安装必备组件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git init </span><br><span class="line">hexo init .</span><br></pre></td></tr></table></figure><p>初始化后，目录结构如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line"> ├── _config.yml # 网站配置信息</span><br><span class="line"> ├── package.json # 应用程序信息</span><br><span class="line"> ├── scaffolds# 模板文件夹</span><br><span class="line"> ├── source # 存放用户资源</span><br><span class="line"> |   ├── _drafts</span><br><span class="line"> |   └── _posts# 存放个人博客</span><br><span class="line"> └── themes # 主题文件夹</span><br></pre></td></tr></table></figure><p>然后输入如下命令，然后在浏览器中打开 <a href="http://localhost:4000/">http://localhost:4000</a> ，就可以预览原始网站</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo new &#x27;博客名&#x27; # 新建博客</span><br><span class="line">hexo g # 生成静态网页</span><br><span class="line">hexo s # 打开本地服务器</span><br></pre></td></tr></table></figure><p>然后就可以看到如下的界面<br><img src="/pictures/github-pages-hexo/2022.10.23.14.48.30.png"></p><h6 id="-6"><a href="#-6" class="headerlink" title=""></a></h6><p><strong>发布到 Github Pages 上面</strong></p><h6 id="-7"><a href="#-7" class="headerlink" title=""></a></h6><p>注册 Github 帐号，有帐号了不用注册</p><h6 id="-8"><a href="#-8" class="headerlink" title=""></a></h6><p>新建一个空仓库，暂时不要创建 README.md ，而且得确保你的仓库是 public 同时，仓库名一定要是 <strong>用户名.github.io</strong></p><h6 id="-9"><a href="#-9" class="headerlink" title=""></a></h6><p>在上文提到的 blogs 文件夹下面安装 hexo-deployer-git</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save hexo-deployer-git</span><br></pre></td></tr></table></figure><h6 id="-10"><a href="#-10" class="headerlink" title=""></a></h6><p>在刚才的博客根目录中的站点配置文件 “_config.yml” ，设置为你的个人仓库名，branch 与你的 git 主分支对应<br><img src="/pictures/github-pages-hexo/v2-376b7a40b8e6a310cc31bd3522ea9a7a_r.jpg"><br><img src="/pictures/github-pages-hexo/v2-d15b384267cf4fa326c2e2febb1b2b62_r.png"></p><h6 id="-11"><a href="#-11" class="headerlink" title=""></a></h6><p>开始推送内容到 Github 上去</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hexo clean # 清理缓存</span><br><span class="line">hexo g     # 将 md 生成 html</span><br><span class="line">git add -A # 添加到 git 缓冲区</span><br><span class="line">git commit -m &quot;first time&quot;# 提交所有更改</span><br><span class="line">hexo d     # 推送到远程</span><br></pre></td></tr></table></figure><p>稍等片刻，就可以访问 https:&#x2F;&#x2F;用户名.github.io 了</p>]]></content>
      
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Github </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Debian Bashrc</title>
      <link href="/2022/10/23/debian-bashrc/"/>
      <url>/2022/10/23/debian-bashrc/</url>
      
        <content type="html"><![CDATA[<p>需要修改 bashrc 的时候，修改 &#x2F;etc&#x2F;bash.bashrc，而不是 ~&#x2F;.bashrc 前者是全局的，下面这一句话就是 &#x2F;etc&#x2F;bash.bashrc 末尾的</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile.d/path.sh</span><br></pre></td></tr></table></figure><p>（环境变量相关）</p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Debian </tag>
            
            <tag> Bash </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Debian Fcitx 中文输入法</title>
      <link href="/2022/10/23/debian-fcitx-%E4%B8%AD%E6%96%87%E8%BE%93%E5%85%A5%E6%B3%95/"/>
      <url>/2022/10/23/debian-fcitx-%E4%B8%AD%E6%96%87%E8%BE%93%E5%85%A5%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>不是中文环境需要进行切换中文环境,可以通过以下命令切换:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo dpkg-reconfigure locales</span><br></pre></td></tr></table></figure><p>至少选择zh_CN.UTF-8</p><p>更新</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update </span><br></pre></td></tr></table></figure><p>安装 fcitx</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install fcitx</span><br></pre></td></tr></table></figure><p>安装 google-pinyin</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install fcitx-googlepinyin</span><br></pre></td></tr></table></figure><p>重启</p><p>命令行输入 im-config 选中fcitx</p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Debian </tag>
            
            <tag> Fcitx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Debian Gnome 默认浏览器</title>
      <link href="/2022/10/23/debian-gnome-default-browser/"/>
      <url>/2022/10/23/debian-gnome-default-browser/</url>
      
        <content type="html"><![CDATA[<p>可以参考里面的指引来设置默认浏览器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://wiki.debian.org/DefaultWebBrowser</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Debian </tag>
            
            <tag> Gnome </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Debian Nvidia 驱动</title>
      <link href="/2022/10/23/debian-nvidia/"/>
      <url>/2022/10/23/debian-nvidia/</url>
      
        <content type="html"><![CDATA[<p>最重要的一点，去 bios 那里关闭 secure boot 先！</p><p>更新</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install nvidia-driver</span><br></pre></td></tr></table></figure><p>重启</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo reboot</span><br></pre></td></tr></table></figure><p>验证是否安装成功</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvidia-smi</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Debian </tag>
            
            <tag> Nvidia </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Bash Powerline Fonts 美化</title>
      <link href="/2022/10/23/linux-bash-powerline-arrow/"/>
      <url>/2022/10/23/linux-bash-powerline-arrow/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/b-ryan/powerline-shell#bash</span><br></pre></td></tr></table></figure><p>留意 README.md 里面的内容，留意如何安装 powerline 字体</p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Bash </tag>
            
            <tag> Powerline </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux 环境变量配置错误处理</title>
      <link href="/2022/10/23/linux-command-not-found-bash/"/>
      <url>/2022/10/23/linux-command-not-found-bash/</url>
      
        <content type="html"><![CDATA[<p>Linux 环境变量配置出错后，提示command not found</p><p>处理方法：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/bin:/usr/sbin:/bin:/sbin</span><br></pre></td></tr></table></figure><p>这样处理后，临时生效环境变量，然后修改配置错误的文件例如.bash_profile   &#x2F;etc&#x2F;profile .bashrc 等，修改后，执行source生效正确的环境变量</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile --根据实际情况修改后面的文件路径</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Bash </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Gnome Desktop File 参考</title>
      <link href="/2022/10/23/linux-debian-gnome-desktop-launch/"/>
      <url>/2022/10/23/linux-debian-gnome-desktop-launch/</url>
      
        <content type="html"><![CDATA[<p>eg:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[Desktop Entry]</span><br><span class="line">Encoding=UTF-8</span><br><span class="line">Name=Tabby</span><br><span class="line">Comment=Tabby</span><br><span class="line">Exec=/home/asleep/softwares/tabby/tabby/tabby %U</span><br><span class="line">Icon=/home/asleep/softwares/tabby/tabby/tabby.svg</span><br><span class="line">Terminal=<span class="literal">false</span></span><br><span class="line">StartupNotify=<span class="literal">true</span></span><br><span class="line">Type=Application</span><br><span class="line">Categories=Application;Development;</span><br><span class="line">StartupWMClass=tabby</span><br></pre></td></tr></table></figure><p>需要改变的是 name，common，exec，icon，startupwmclass</p><p>.desktop 文件位于 &#x2F;usr&#x2F;share&#x2F;application&#x2F; 下面</p><p>StartupWMClass</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xprop | grep CLASS</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Gnome </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux VScode 字体</title>
      <link href="/2022/10/23/linux-debian-vscode-fonts-firacode/"/>
      <url>/2022/10/23/linux-debian-vscode-fonts-firacode/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/tonsky/FiraCode</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> VScode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nodejs 换源</title>
      <link href="/2022/10/23/node%20%E6%8D%A2%E6%BA%90%20%E9%98%BF%E9%87%8C/"/>
      <url>/2022/10/23/node%20%E6%8D%A2%E6%BA%90%20%E9%98%BF%E9%87%8C/</url>
      
        <content type="html"><![CDATA[<p>由于 Node 的官方模块仓库网速太慢，模块仓库需要切换到阿里的源</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org/</span><br></pre></td></tr></table></figure><p>执行下面的命令，确认是否切换成功</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config get registry</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Nodejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux 环境变量配置</title>
      <link href="/2022/10/23/path.sh%20gopath%20alias/"/>
      <url>/2022/10/23/path.sh%20gopath%20alias/</url>
      
        <content type="html"><![CDATA[<p>&#x2F;etc&#x2F;profile.d&#x2F;path.sh</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/home/asleep/softwares/conda/conda/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/home/asleep/softwares/qrcp/qrcp</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/home/asleep/softwares/nodejs/nodejs/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/home/asleep/softwares/baidunetdisk/baidunetdisk/opt/baidunetdisk</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/home/asleep/softwares/adb/adb</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/home/asleep/softwares/wine/wine</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/home/asleep/softwares/neovim/neovim</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/home/asleep/softwares/go/go_path/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/home/asleep/softwares/autossh/autossh</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> GOROOT=<span class="string">&#x27;/home/asleep/softwares/go/go_base/go&#x27;</span></span><br><span class="line"><span class="built_in">export</span> GOPATH=<span class="string">&#x27;/home/asleep/softwares/go/go_path&#x27;</span></span><br><span class="line"><span class="built_in">export</span> GOCACHE=<span class="string">&#x27;/home/asleep/softwares/go/go_cache&#x27;</span></span><br><span class="line"><span class="built_in">export</span> GOENV=<span class="string">&#x27;/home/asleep/softwares/go/go_env&#x27;</span></span><br><span class="line"><span class="comment"># export GOMOD=&#x27;/home/asleep/softwares/go/go_mod&#x27;</span></span><br><span class="line"><span class="built_in">export</span> GO111MODULE=<span class="string">&#x27;auto&#x27;</span></span><br><span class="line"><span class="comment"># export GOWORK=&#x27;/home/asleep/softwares/go/go_work&#x27;</span></span><br><span class="line"><span class="built_in">export</span> GOPROXY=<span class="string">&#x27;https://goproxy.cn/,direct&#x27;</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/home/asleep/softwares/go/go_base/go/bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># alias vim=&#x27;vim.tiny&#x27;</span></span><br><span class="line"><span class="comment"># alias sudo=&#x27;sudo &#x27;</span></span><br></pre></td></tr></table></figure><p>这里只能存 path 和 alias，其他的能在 &#x2F;etc&#x2F;bash.bashrc 里面解决就在那里解决，原则！</p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Bash </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VIM 批量查找替换</title>
      <link href="/2022/10/23/vim-nvim-replace-%E6%89%B9%E9%87%8F%E6%9F%A5%E6%89%BE%E6%9B%BF%E6%8D%A2/"/>
      <url>/2022/10/23/vim-nvim-replace-%E6%89%B9%E9%87%8F%E6%9F%A5%E6%89%BE%E6%9B%BF%E6%8D%A2/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># 当前行进行替换</span><br><span class="line">:s/XXX/YYY/g</span><br><span class="line"># XXX是需要替换的字符串,YYY是替换后的字符串</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 全局替换</span><br><span class="line">:% s/XXX/YYY/g</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 对指定部分进行替换用V进入visual模式,再进行</span><br><span class="line">:s/XXX/YYY/g</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 或指定行范围 替换</span><br><span class="line">:100,102s/XXX/YYY/g</span><br><span class="line"></span><br><span class="line"># 模糊查找不区分大小写，在要查找的内容后面加上 \c 就行</span><br><span class="line">:/xxx\c</span><br><span class="line">:s/XXX\c/YYY/g</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> VIM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>The First Blog</title>
      <link href="/2022/10/22/The-First-Blog/"/>
      <url>/2022/10/22/The-First-Blog/</url>
      
        <content type="html"><![CDATA[<p>“开始记录进步与欢乐！”</p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
